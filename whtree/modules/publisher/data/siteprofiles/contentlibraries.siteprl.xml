<siteprofile xmlns="http://www.webhare.net/xmlns/publisher/siteprofile" gid="siteprofile.contentlibraries">

  <foldertype namespace="http://www.webhare.net/xmlns/publisher/contentlibraries/slots"
              comment="adaptive content slots (folder of slots)"
              icon="tollium:objects/slots"
              tid=".slots">
    <foldersettings>
      <contentslisthandler objectname="/tolliumapps/filemanager/adaptivecontent.whlib#SlotsFolderContents" />
    </foldersettings>
  </foldertype>

  <apply comment="add condition columns to slot widgets">
    <to type="folder" parenttype="http://www.webhare.net/xmlns/publisher/contentlibraries/slots" />
    <foldersettings>
      <contentslisthandler objectname="/tolliumapps/filemanager/adaptivecontent.whlib#SlotFolderContents" />
    </foldersettings>
  </apply>

  <apply comment="check for slot republishing if a slot or widget changes">
    <to type="all" withintype="http://www.webhare.net/xmlns/publisher/contentlibraries/slots" />
    <scheduletimedtask task="publisher:updateslots" />
  </apply>

  <contenttype namespace="http://www.webhare.net/xmlns/publisher/contentlibraries/slottedwidget"
               comment="slottedwidget properties">
    <record name="condition" />
  </contenttype>

  <foldertype namespace="http://www.webhare.net/xmlns/publisher/contentlibraries/beacons"
              icon="tollium:folders/beaconfolder"
              tid=".beacons">
    <foldersettings>
      <contentslisthandler objectname="/tolliumapps/filemanager/adaptivecontent.whlib#BeaconsFolderContents" />
    </foldersettings>
  </foldertype>

  <apply priority="10">
    <to type="all" parenttype="http://www.webhare.net/xmlns/publisher/contentlibraries/beacons" />
    <denyfoldertype typemask="*" />
    <denyfiletype typemask="*" />
    <allowfiletype typemask="http://www.webhare.net/xmlns/publisher/contentlibraries/beacon" />
  </apply>

  <apply comment="Apply references to slots">
    <to type="folder" withintype="http://www.webhare.net/xmlns/publisher/contentlibraries/slots" />

    <!-- set a contenttype because it's required, but we don't really care about it -->
    <extendproperties extension="/tolliumapps/objectprops/references.xml#referencestab"
                      contenttype="http://www.webhare.net/xmlns/publisher/contentlibraries/slottedwidget" />
  </apply>

  <filetype namespace="http://www.webhare.net/xmlns/publisher/contentlibraries/beacon"
            kind="datafile"
            comment="beacon file type"
            icon="tollium:objects/beacon"
            tid=".beacon">
    <members>
      <string name="guid" />
    </members>
    <setobjecteditor name="publisher:adaptivecontent_beacon" />
    <extendproperties extension="/tolliumapps/objectprops/references.xml#referencestab" />
  </filetype>

  <foldertype namespace="http://www.webhare.net/xmlns/publisher/contentlibraries/contentsnippets"
              comment="content snippets"
              icon="tollium:folders/snippetfolder"
              tid=".contentsnippets">
    <foldersettings>
      <contentslisthandler objectname="/tolliumapps/filemanager/contentsnippets.whlib#SnippetsFolderContents" />
    </foldersettings>
  </foldertype>

  <apply priority="10">
    <to type="all" withintype="http://www.webhare.net/xmlns/publisher/contentlibraries/contentsnippets" />

    <!-- republish associated content if a content snippet changes -->
    <republish scope="references" />

    <!-- permit only our snippets type, as we've adjusted the interface in these folders to only support these. -->
    <denyfoldertype typemask="*" />
    <denyfiletype typemask="*" />
    <allowfiletype typemask="http://www.webhare.net/xmlns/publisher/widgets/contentsnippet" />
  </apply>

</siteprofile>
