<?wh

LOADLIB "mod::publisher/lib/internal/rtd/previewcontext.whlib";


PUBLIC OBJECTTYPE EmailWidgetContext EXTEND PreviewContext
<
  OBJECT __mailcomposer;

  PUBLIC PROPERTY mailcomposer(__mailcomposer, -);

  MACRO NEW(OBJECT mailcomposer, OBJECT fsobject, OBJECT applytester, RECORD rtdtypeinfo, BOOLEAN forsearch)
  : PreviewContext(fsobject, applytester, rtdtypeinfo, forsearch)
  {
    this->__mailcomposer := mailcomposer;
  }

  UPDATE PUBLIC MACRO PTR FUNCTION GetRTDBody(RECORD richdoc, RECORD options DEFAULTSTO DEFAULT RECORD)
  {
    RETURN this->__mailcomposer->GetRTDBody(richdoc, CELL[__mergecontext := CELL[ this->applytester, rtdtype := this->rtdtypeinfo, context := this ], ...options]);
  }
>;
