<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         library="assetpackcontrol.whlib"
         gid="monitor.assetpackcontrol">

  <messageboxes gid=".dialogs">
    <messagebox name="confirmdeletebundles" buttons="yes no" />
    <messagebox name="surerebuildall" buttons="yes no" />
  </messageboxes>

  <screen name="assetpackcontrolpanel" gid=".assetpackcontrolpanel"
          width="80x" title="">
    <actions>
      <action name="deletebundles" tid="tollium:common.actions.delete">
        <enableon source="bundles" min="1" onexecute="dodeletebundles" checkflags="candelete" />
      </action>
      <action name="bundleproperties" tid="tollium:common.actions.properties">
        <enableon source="bundles" min="1" max="1" onexecute="dobundleproperties" />
      </action>
      <action name="recompilebundles">
        <enableon source="bundles" min="1" onexecute="dorecompilebundles" />
      </action>
      <action name="rebuildbundles">
        <enableon source="bundles" min="1" onexecute="dorebuildbundles" />
      </action>
      <action name="rebuildall" onexecute="dorebuildall" />
    </actions>
    <menus>
      <menu name="bundlecontextmenu">
        <item action="recompilebundles" />
        <item action="bundleproperties" />
      </menu>
    </menus>
    <compositions>
      <eventlistener name="listener" masks="publisher:assetpackcontrol.change.* publisher:assetpackcontrol.watch.* system:webhareservice.publisher:assetpackcontrol.start" onevents="onassetevent" />
      <eventlistener name="configlistener" masks="system:registry.publisher.bundledassets" onevents="onconfigevent" />
    </compositions>
    <body>
      <split type="vertical">
        <part height="2pr">
          <grid height="1pr">
            <col width="1pr" />
            <col />
            <row height="1pr">
              <cell >
                <list height="1pr"
                      name="bundles"
                      selectmode="multiple"
                      openaction="bundleproperties"
                      onselect="onbundleselect"
                      selectcontextmenu="bundlecontextmenu"
                      sortcolumn="outputtag"
                      flags="candelete"
                      borders="right">
                  <column name="status" type="text" width="12x" />
                  <column name="outputtag" type="text" width="25x" />
                  <column name="lastcompile" type="datetime" storeutc="true" width="23x" precision="seconds" />
                  <column name="watchcount" type="text" align="right" width="10x" />
                </list>
              </cell>
              <cell layout="left" spacers="top left right">
                <button action="bundleproperties" width="1pr" />
                <button action="deletebundles" width="1pr" />
                <!-- <br/> -->
                <button action="recompilebundles" width="1pr" />
                <button action="rebuildbundles" width="1pr" />
                <button action="rebuildall" width="1pr" />
                <spacer height="1gr" />
                <checkbox name="suspendautocompile" title="" labeltid=".suspendautocompile" onchange="onautocompilechange" />
              </cell>
            </row>
          </grid>
        </part>
        <part height="1pr">
          <split height="1pr" type="horizontal">
            <part width="1pr">
              <list height="1pr"
                    name="messages"
                    selectmode="single"
                    borders="none"
                    onselect="onselectmessage">
                <column name="message" type="text" />
              </list>
            </part>
            <part width="1pr">
              <codeedit name="message" enabled="false" width="1pr" height="1pr" />
            </part>
          </split>
        </part>
      </split>
    </body>
  </screen>

  <screen name="bundleprops" gid=".bundleprops" width="60x" allowresize="true" savestate="size">
    <compositions>
      <eventlistener name="listener" onevents="gotevents" />
    </compositions>
    <body spacers="none">
      <tabs>
        <tab tid=".tab_overview">
          <textedit enabled="false" name="outputtag" width="1pr" />
          <textedit enabled="false" name="entrypoint" width="1pr" />
          <textarea enabled="false" name="stats" height="8x" width="1pr" />
          <textarea enabled="false" name="errors" height="8x" width="1pr" />
          <textarea enabled="false" name="extrarequires" height="8x" width="1pr" />
          <textedit enabled="false" name="languages" width="1pr" />
          <textedit enabled="false" name="environment" width="1pr" />
          <textarea enabled="false" name="missingdependencies" height="8x" width="1pr" />
        </tab>
        <tab tid=".tab_filedependencies">
          <!-- FIXME: make tree and collapse on either the last folder OR node_modules/*/ -->
          <list name="filedependencies"
                selectmode="single"
                >
            <column name="path" type="text" />
          </list>
        </tab>
      </tabs>
    </body>
    <footer>
      <defaultformbuttons buttons="close" />
    </footer>
  </screen>

</screens>
