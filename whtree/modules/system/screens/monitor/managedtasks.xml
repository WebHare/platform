<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         lib="screens/monitor/managedtasks.whlib"
         gid="screens.monitor.managedtasks">

  <messageboxes>
    <messagebox name="confirmrescheduletasks" buttons="yes no" />
    <messagebox name="confirmdeletetasks" buttons="yes no" />
  </messageboxes>

  <screen name="panel" gid=".panel" title="">
    <actions>
      <action name="flush" onexecute="doflush" />

      <action name="reschedule" onexecute="doreschedule">
        <enableon source="managedtasks" min="1" checkflags="canreschedule" />
      </action>
      <action name="view" onexecute="doview"  tid="tollium:common.actions.view">
        <enableon source="managedtasks" min="1" max="1" />
      </action>
      <action name="delete" onexecute="dodelete" shortcut="del"  tid="tollium:common.actions.delete">
        <enableon source="managedtasks" min="1" />
      </action>
    </actions>

    <menus>
      <menu name="selectionmenu">
        <item action="view"/>
        <item action="reschedule"/>
        <item action="delete" />
      </menu>

      <menu name="queuemenu">
        <item action="flush"/>
      </menu>
    </menus>

    <compositions>
      <eventlistener name="listener" masks="system:managedtasks.any.*" onevents="onmanagedtaskevent" />
    </compositions>

    <body height="1pr">
      <grid height="1pr">
        <col width="1pr" />
        <col />
        <row height='1pr'>
          <cell>
            <panel height="1pr">
              <list name="managedtasks"
                    icons="tollium:status/wait tollium:status/error tollium:status/checked tollium:status/not_available tollium:status/checked tollium:status/neutral"
                    selectmode="multiple"
                    selectcontextmenu="selectionmenu"
                    newcontextmenu="queuemenu"
                    sortcolumn="creationdate"
                    openaction="view"
                    width="1pr"
                    height="1pr"
                    sortascending="false"
                    flags="canreschedule hasfailed"
                    borders="right bottom"
                    >
                <column type="datetime" name="creationdate" storeutc="true" width="18x" />
                <column type="text"     name="tasktype" />
                <column type="integer"  name="rowkey" tid="tollium:common.labels.id" />
                <column type="icon"     name="status" align="center" width="7x" tid="tollium:common.labels.status" />
                <column type="datetime" name="nextattempt" storeutc="true" />
              </list>
            </panel>
          </cell>
          <cell spacers="left right" layout="left">
            <checkbox name="showcompletedtasks" onchange="RefreshDashboardPanel" title="" labeltid=".showcompletedtasks" />
            <button width="1pr" action="view"          />
            <button width="1pr" action="flush"                />
            <button width="1pr" action="delete" />
          </cell>
        </row>
      </grid>
    </body>
  </screen>

  <screen name="managedtask" gid=".managedtask" allowresize="true" savestate="size" width="90x" height="25x">
    <compositions>
      <eventlistener name="listener" onevents="OnChangeEvents" />
    </compositions>
    <body spacers="none">
      <panel spacers="all">
        <text name="id" />
        <datetime name="creationdate" readonly="true" storeutc="true" type="datetime" precision="seconds" />
        <datetime name="nextattempt" readonly="true" storeutc="true" type="datetime" precision="seconds" />
        <datetime name="finished" readonly="true" storeutc="true" type="datetime" precision="seconds" />
        <textedit name="manualcall" enabled="false" width="1pr" />
        <textarea name="lasterrors" enabled="false" />
      </panel>
      <tabs height="1pr">
        <tab tid=".datatab" spacers="none">
          <hsvalue name="data" />
        </tab>
        <tab tid=".returnvaluetab"  spacers="none">
          <hsvalue name="retval" />
        </tab>
        <tab tid=".metadatatab" spacers="none">
          <hsvalue name="metadata" />
        </tab>
      </tabs>
    </body>
    <footer>
      <defaultformbuttons buttons="close" />
    </footer>
  </screen>

</screens>
