<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         xmlns:system="http://www.webhare.net/xmlns/system/components"
         library="/lib/screens/userrights/parts/unitcontents.whlib">

  <!-- list of users & roles within a unit -->
  <fragment name="unitcontents" gid="userrights.unitcontents">
    <actions gid="userrights.actions">
      <action name="newuser" enabled="false" hinttid=".newuser-hint" onexecute="doadduser" />
      <action name="newrole" enabled="false" hinttid=".newrole-hint" onexecute="doaddrole" />
      <action name="addroletousers" ellipsis="true" hinttid=".addroletousers-hint" onexecute="doaddroletousers">
        <enableon source="userandrolelist" min="1" checkflags="!isrole" />
      </action>
      <action name="addrighttousers" ellipsis="true" hinttid=".addrighttousers-hint" onexecute="doaddrighttousers">
        <enableon source="userandrolelist" min="1" />
      </action>
      <action name="adduserstorole" ellipsis="true">
        <enableon source="userandrolelist" min="1" max="1" checkflags="isrole canedit" onexecute="doadduserstorole" />
      </action>
      <action name="move" ellipsis="true" hinttid=".move-hint">
        <enableon source="userandrolelist" min="1" checkflags="candelete" onexecute="domoveitemstoanotherunit" />
      </action>
      <action name="delete" ellipsis="true" hinttid=".delete-hint" shortcut="del" tid="~delete">
        <enableon source="userandrolelist" min="1" checkflags="candelete" onexecute="dodeleteuserorrole" requirefocus="true" />
      </action>
      <action name="edit" hinttid=".edit-hint">
        <enableon source="userandrolelist" min="1" max="1" checkflags="isrole canedit" onexecute="doeditrole" />
        <enableon source="userandrolelist" min="1" max="1" checkflags="!isrole canedit" onexecute="doedituser" />
      </action>
      <action name="getresetlink" ellipsis="true">
        <enableon source="userandrolelist" min="1" max="1" checkflags="!isrole canedit" onexecute="dogetresetlink" />
      </action>
      <action name="apikeys">
        <enableon source="userandrolelist" min="1" max="1" checkflags="!isrole canedit" onexecute="doapikeys" />
      </action>
      <windowopenaction name="openas" hinttid=".openas-hint">
        <enableon source="userandrolelist" min="1" max="1" checkflags="canopenas" onwindowopen="doopenas" />
      </windowopenaction>
      <action name="showauditlog" hinttid=".showauditlog-hint">
        <enableon source="userandrolelist" min="1" max="1" onexecute="DoShowAuditLog" requirefocus="true" />
      </action>
    </actions>
    <menus>
      <menu name="selectcontextmenu">
        <item action="addroletousers" disablemode="hidden" />
        <item action="addrighttousers" disablemode="hidden" />
        <item action="adduserstorole" disablemode="hidden" tid="userrights.actions.adduserstorole" />
        <divider />
        <item action="move" />
        <item action="delete" />
        <divider />
        <item action="getresetlink" />
        <item action="openas" disablemode="hidden" />
        <item action="apikeys" disablemode="hidden" />
        <divider />
        <item action="showauditlog" disablemode="hidden" />
        <divider />
        <item action="edit" />
      </menu>
      <menu name="newcontextmenu">
        <item action="newuser" disablemode="hidden" />
        <item action="newrole" disablemode="hidden" />
      </menu>
    </menus>
    <contents>
      <list name="userandrolelist"
            borders="all"
            emptytid="userrights.empty.usersinunits"
            flags="isrole canedit candelete canopenas"
            gid="tolliumapps.userrights.common"
            newcontextmenu="newcontextmenu"
            onselect="onselecthandler"
            openaction="edit"
            rowkeytype="entityid"
            selectcontextmenu="selectcontextmenu"
            selectmode="multiple">
        <acceptdrops ondrop="ontypeddrop">
          <accepttype type="system:role" dropeffects="move" sourceflags="candelete" targetflags="canmanage" />
          <accepttype type="system:user" dropeffects="move" sourceflags="candelete" targetflags="canmanage" />
        </acceptdrops>
        <column name="name" type="text" width="30x" iconname="icon" />
        <column name="fullname" type="text" width="1pr" />
        <column name="email" type="text" width="1pr" tid="~email" />
        <column name="lastlogin" type="datetime" width="1pr" storeutc="true" />
        <column name="unitpath" type="text" width="1pr" tid=".unit" />
        <column name="online" type="icon" width="20px" align="center" sortkeyname="online_login" title="" />
      </list>
    </contents>
  </fragment>

  <screen name="prepareresetlink" footerbuttons="ok cancel" gid="userrights.prepareresetlink">
    <body>
      <select name="resettype" type="radio" title="">
        <option rowkey="directresetlink" />
        <option rowkey="codedresetlink" />
      </select>
    </body>
  </screen>

  <screen name="getresetlink" footerbuttons="close" gid="userrights.getresetlink">
    <actions>
      <copyaction name="copyresetcode" source="resetcode" title="" />
    </actions>

    <body>
      <url name="resetlink" width="80x" />
      <textedit name="resetcode" width="80x" enabled="false">
        <button action="copyresetcode" icon="tollium:actions/copy" title="" />
      </textedit>
    </body>
  </screen>

</screens>
