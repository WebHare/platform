<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         gid="debugger.profiles"
         library="/lib/screens/debugger/profiles.whlib">

  <screen name="main"
          width="180x"
          height="60x"
          allowresize="true"
          menubar="menubar"
          onunload="gotunload"
          savestate="size"
          tid=".apptitle">
    <actions>
      <action name="childopen" onexecute="dochildopen">
        <enableon source="childrencalls" min="1" />
      </action>
      <action name="parentopen" onexecute="doparentopen">
        <enableon source="parentcalls" min="1" />
      </action>
      <action name="clearlist" onexecute="doclearlist" />
      <action name="closeapp" onexecute="cancel" shortcut="ctrl+q" tid="~close" />
      <action name="webserveradhoccache" onexecute="dowebserveradhoccache" />
      <action name="clearallcaches" onexecute="doclearallcaches" />
      <action name="editsource" tid="~openineditor">
        <enableon source="functionslist" min="1" max="1" onexecute="doeditsource" />
        <enableon source="childrencalls" min="1" max="1" onexecute="doeditchildrencallsource" />
        <enableon source="parentcalls" min="1" max="1" onexecute="doeditparentcallsource" />
        <enableon source="stacktracelist" min="1" max="1" onexecute="doeditstacktracesource" />
      </action>
    </actions>

    <menus>
      <menu name="menubar">
        <item tid=".apptitle">
          <item action="clearlist" />
          <divider />
          <item action="closeapp" />
        </item>
        <item tid=".caches">
          <item action="webserveradhoccache" />
          <item action="clearallcaches" />
        </item>
      </menu>
      <menu name="functionscontext">
        <item action="editsource" />
      </menu>
      <menu name="childrencallscontext">
        <item action="editsource" />
      </menu>
      <menu name="parentcallscontext">
        <item action="editsource" />
      </menu>
      <menu name="stacktracecontext">
        <item action="editsource" />
      </menu>
    </menus>

    <compositions>
      <eventlistener name="diskprofilelistener" groupinterval="2000" onevents="OnNewStoredProfile" />
    </compositions>

    <toolbar>
      <button action="clearlist" />
      <button action="clearallcaches" tid=".button-clearallcaches" />
    </toolbar>

    <body height="1pr">
      <split type="vertical" height="1pr">
        <part height="2pr">
          <split type="horizontal" height="1pr">
            <part name="profilelistpart" width="1pr">
              <select name="session" type="pulldown" />
              <list name="profileslist" borders="top left" onselect="onprofileselected" selectmode="single">
                <column name="when" type="time" width="13x" precision="milliseconds" />

<!-- <column name="source" type="text" width="20x" /> -->
                <column name="command" type="text" />

<!-- <column name="type" type="text" width="18x" /> show it as an icon or something if we really need it, but the two row layout was really ugly -->
                <column name="info" type="text" width="16x" align="right" sortkeyname="infosortval" />
              </list>
            </part>
            <part name="functionslistpart" width="2pr">
              <list name="functionslist"
                    borders="top right"
                    ongetchildren="getfunctionlistrows"
                    ongetpath="getgenericpath"
                    onselect="onfunctionselected"
                    rowkeytype="string"
                    selectcontextmenu="functionscontext"
                    selectmode="single"
                    sortascending="false"
                    sortcolumn="totalheap">
                <column name="functionname" type="text" width="3pr" />
                <column name="library" type="text" width="2pr" />
              </list>
            </part>
            <part name="nameslistpart" width="2pr" visible="false">
              <list name="nameslist"
                    borders="top right"
                    ongetchildren="getnameslistrows"
                    ongetpath="getgenericpath"
                    onselect="onnameselected"
                    rowkeytype="string"
                    selectmode="single"
                    sortascending="false"
                    sortcolumn="totalheap">
                <column name="name" type="text" width="3pr" />
              </list>
            </part>
          </split>
        </part>
        <part name="relationspart" height="1pr">
          <panel height="1pr" borders="left right">
            <tabs name="calltree" height="1pr">
              <tab name="ct_children" spacers="none">
                <list name="childrencalls"
                      borders="bottom"
                      ongetchildren="getchildrenlistrows"
                      ongetpath="getgenericpath"
                      openaction="childopen"
                      selectcontextmenu="childrencallscontext"
                      selectmode="single"
                      sortascending="false"
                      sortcolumn="totaltime">
                  <column name="functionname" type="text" width="3pr" tree="true" />
                  <column name="library" type="text" width="2pr" />
                </list>
              </tab>
              <tab name="ct_parents" spacers="none">
                <list name="parentcalls"
                      borders="bottom"
                      ongetchildren="getparentlistrows"
                      ongetpath="getgenericpath"
                      openaction="parentopen"
                      selectcontextmenu="parentcallscontext"
                      selectmode="single"
                      sortascending="false"
                      sortcolumn="totaltime">
                  <column name="functionname" type="text" width="3pr" tree="true" />
                  <column name="library" type="text" width="2pr" />
                </list>
              </tab>
              <tab name="ct_trace" spacers="none">
                <list name="stacktracelist"
                      borders="bottom"
                      emptytid=".nostacktraceavailable"
                      ongetrows="getstacktracerows"
                      selectcontextmenu="stacktracecontext"
                      selectmode="single"
                      sortable="false"
                      sortascending="false">
                  <column name="functionname" type="text" width="3pr" tree="true" />
                  <column name="library" type="text" width="2pr" />
                </list>
              </tab>
            </tabs>
          </panel>
        </part>
      </split>
    </body>
  </screen>

</screens>
