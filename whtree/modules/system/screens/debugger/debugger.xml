<screens xmlns="http://www.webhare.net/xmlns/tollium/screens" gid="debugger" library="/lib/screens/debugger/debugger.whlib">

  <!-- main debugger screen: current connected job
  -->
  <screen name="main"
          allowresize="true"
          flags="candetach canpause cancontinue havefile canviewvariables have_catalog runningprofile canrundelayedaction"
          icon="tollium:objects/bug"
          menubar="menubar">
    <actions>
      <action name="debugconfig" onexecute="dodebugconfig" />
      <action name="openfile" onexecute="doopenfile" shortcut="ctrl+o" />
      <action name="closefile" onexecute="doclosefile">
        <enableon source="files" min="1" />
      </action>
      <action name="symbolsearch" frameflags="have_catalog" onexecute="dosymbolsearch" shortcut="f3" />
      <action name="exit" onexecute="doexit" />
      <action name="selectjob" onexecute="doselectjob" />
      <action name="ruleconnect" onexecute="doruleconnect" />
      <action name="changeautoreconnect" onexecute="dochangeautoreconnect" />
      <action name="pausejob" frameflags="canpause" onexecute="dopausejob" />
      <action name="continuejob" frameflags="cancontinue" onexecute="docontinuejob" shortcut="f8" />
      <action name="stepjob" frameflags="cancontinue" onexecute="dostepjob" shortcut="f10" />
      <action name="stepintojob" frameflags="cancontinue" onexecute="dostepintojob" shortcut="f11" />
      <action name="stepoutjob" frameflags="cancontinue" onexecute="dostepoutjob" shortcut="shift+f11" />
      <action name="runtocursor" frameflags="cancontinue havefile" onexecute="doruntocursor" shortcut="alt+f11" />
      <action name="detachjob" frameflags="candetach" onexecute="dodetachjob" />
      <action name="openstacktraceitem" onexecute="doopenstacktraceitem">
        <enableon source="stacktrace" min="1" />
      </action>
      <action name="openbreakpoint" onexecute="doopenbreakpoint">
        <enableon source="breakpoints" min="1" />
      </action>
      <action name="removebreakpoint" onexecute="doremovebreakpoint">
        <enableon source="breakpoints" min="1" />
      </action>
      <action name="removeallbreakpoints" onexecute="doremoveallbreakpoints" />
      <action name="viewframevariable" frameflags="canviewvariables" onexecute="doviewframevariable">
        <enableon source="framevariables" min="1" />
      </action>
      <action name="showerrortext" onexecute="doshowerrortext" />
      <action name="getmemorysnapshot" frameflags="canrundelayedaction" onexecute="dogetmemorysnapshot" />
      <action name="getmemorysnapshotwithunreferenced"
              frameflags="canrundelayedaction"
              onexecute="dogetmemorysnapshotwithunreferenced" />
      <action name="getobjectsnapshot" frameflags="canrundelayedaction" onexecute="dogetobjectsnapshot" />
      <action name="getblobreferences" frameflags="canrundelayedaction" onexecute="dogetblobreferenceswithunreferenced" />
      <action name="gethandlelist" frameflags="canrundelayedaction" onexecute="dogethandlelist" />
      <action name="getadhoccachelist" frameflags="canrundelayedaction" onexecute="dogetadhoccachelist" />
      <action name="showprofiles" onexecute="doshowprofiles" />
      <action name="startfunctionprofiling"
              frameflags="canrundelayedaction !runningprofile"
              onexecute="dostartfunctionprofiling" />
      <action name="startmemoryprofiling" frameflags="canrundelayedaction !runningprofile" onexecute="dostartmemoryprofiling" />
      <action name="stopprofiling" frameflags="canrundelayedaction runningprofile" onexecute="dostopprofiling" />
      <action name="openineditor" tid="~openineditor">
        <enableon source="files" min="1" onexecute="doopenfileineditor" />
        <enableon source="stacktrace" min="1" onexecute="doopenstacktraceitemineditor" />
        <enableon source="breakpoints" min="1" onexecute="doopenbreakpointineditor" />
      </action>
    </actions>

    <menus>
      <menu name="menubar">
        <item tid=".file">
          <item action="openfile" />
          <item action="closefile" />
          <divider />
          <item action="selectjob" />
          <item action="ruleconnect" />
          <divider />
          <item action="symbolsearch" disablemode="hidden" />
          <divider />
          <item action="exit" />
        </item>
        <item tid=".control">
          <item action="continuejob" />
          <item action="pausejob" />
          <item action="stepjob" />
          <item action="stepintojob" />
          <item action="stepoutjob" />
          <item action="runtocursor" />
          <item action="detachjob" />
        </item>
        <item tid=".snapshots">
          <item action="getmemorysnapshot" />
          <item action="getmemorysnapshotwithunreferenced" />
          <item action="getobjectsnapshot" />
          <item action="getblobreferences" />
          <item action="gethandlelist" />
          <item action="getadhoccachelist" />
          <item action="startfunctionprofiling" />
          <item action="startmemoryprofiling" />
          <item action="stopprofiling" />
          <divider />
          <item action="showprofiles" />
        </item>
      </menu>
      <menu name="files_context">
        <item action="openfile" />
        <item action="closefile" disablemode="hidden" />
        <divider />
        <item action="openineditor" />
      </menu>
      <menu name="stacktrace_context">
        <item action="openineditor" />
      </menu>
      <menu name="breakpoints_context">
        <item action="openbreakpoint" />
        <item action="removebreakpoint" disablemode="hidden" />
        <item action="removeallbreakpoints" disablemode="hidden" />
        <divider />
        <item action="openineditor" />
      </menu>
    </menus>

    <toolbar>
      <button action="debugconfig" icon="tollium:actions/configure" />
      <divider />
      <button action="selectjob" icon="tollium:applications/monitoring" />
      <button action="ruleconnect" icon="tollium:actions/link" />
      <button name="autoreconnect" action="changeautoreconnect" icon="tollium:actions/autolink" />
      <divider />
      <button action="continuejob" icon="tollium:actions/play" />
      <button action="pausejob" icon="tollium:actions/pause" />
      <button action="stepjob" icon="tollium:actions/skip" />
      <button action="stepintojob" icon="tollium:actions/stepinto" />
      <button action="stepoutjob" icon="tollium:actions/stepoutof" />
      <button action="runtocursor" icon="tollium:actions/runtocursor" />
      <button action="detachjob" icon="tollium:actions/unlink" />
    </toolbar>

    <body>
      <split type="horizontal">
        <part width="30x">
          <panel height="1pr">
            <panel backgroundcolor="#f0f0f0" borders="top left">
              <line layout="tabs-space">
                <spacer width="4px" />
                <text valuetid=".files" />
                <spacer />
                <buttongroup layout="horizontal">
                  <button action="openfile" icon="tollium:actions/open" />
                  <button action="closefile" icon="tollium:objects/cross" />
                </buttongroup>
              </line>
            </panel>
            <list name="files"
                  height="1pr"
                  borders="top left bottom"
                  columnheaders="false"
                  newcontextmenu="files_context"
                  onselect="gotselectfile"
                  rowkeytype="string"
                  selectcontextmenu="files_context"
                  selectevent="synchronous"
                  selectmode="single">
              <column name="filename" type="text" tree="true" />
            </list>
          </panel>
        </part>
        <part width="3pr" borders="top bottom">
          <panel name="filestatus" backgroundcolor="#FFFEE2" borders="bottom" spacers="left right" visible="false">
            <grid name="stoppedwitherror" visible="false">
              <col width="1pr" />
              <col />
              <row>
                <cell>
                  <text title="" valuetid=".stoppedwitherror" />
                </cell>
                <cell>
                  <button action="showerrortext" />
                </cell>
              </row>
            </grid>
            <text name="filehasbeenchanged" title="" valuetid=".filehasbeenchanged" visible="false" />
            <text name="multiplesourceversionsloaded" title="" valuetid=".multiplesourceversionsloaded" visible="false" />
          </panel>
          <codeedit name="filecontents" height="1pr" enabled="false" ongutterclick="gotgutterclick" />
        </part>
        <part width="50x">
          <split type="vertical">
            <part height="2pr">
              <panel borders="top right bottom" spacers="left">
                <line>
                  <text name="status" tid=".status.status" />
                  <text name="profilestatus" title="" />
                </line>
              </panel>
              <list name="stacktrace"
                    height="1pr"
                    borders="right"
                    onselect="gotstacktraceitemselect"
                    openaction="openstacktraceitem"
                    rowlayout="tworows"
                    selectcontextmenu="stacktrace_context"
                    selectmode="single"
                    sortable="false">
                <column name="filename" type="text" />
                <column name="position" type="text" width="10x" />
                <column name="func" type="text" tid=".stacktrace-function" />
                <rowlayout name="tworows">
                  <col coldef="func" />
                  <col coldef="position" />
                  <row>
                    <cell coldef="filename" colspan="2" />
                  </row>
                  <row>
                    <cell coldef="func" />
                    <cell coldef="position" />
                  </row>
                </rowlayout>
              </list>
            </part>
            <part height="1pr">
              <list name="framevariables" borders="right" openaction="viewframevariable" selectmode="single">
                <column name="name" type="text" tid=".framevariable" />
                <column name="value" type="text" width="2pr" />
              </list>
            </part>
            <part height="1pr">
              <list name="breakpoints"
                    height="1pr"
                    borders="right bottom"
                    newcontextmenu="breakpoints_context"
                    openaction="openbreakpoint"
                    selectcontextmenu="breakpoints_context"
                    selectmode="multiple">
                <column name="filename" type="text" tid=".breakpoint-filename" />
                <column name="line" type="integer" width="7x" />
              </list>
              <panel layout="left" spacers="left">
                <checkbox name="breakonexception" labeltid=".breakonexception" onchange="GotBreakOnExceptionChange" title="" />
              </panel>
            </part>
          </split>
        </part>
      </split>
      <textarea name="textarea" width="1pr" visible="false" />
    </body>
  </screen>

  <screen name="selectjob"
          width="150x"
          height="30x"
          allowresize="true"
          gid=".selectjob"
          interval="1000"
          oninterval="gotinterval"
          onunload="gotunload"
          savestate="size">
    <actions>
      <action name="connect" onexecute="submit">
        <enableon source="joblist" min="1" checkflags="canconnect" />
      </action>
      <action name="disconnect" onexecute="dodisconnect">
        <enableon source="joblist" min="1" checkflags="candisconnect" />
      </action>
      <action name="terminate" onexecute="doterminate">
        <enableon source="joblist" min="1" checkflags="canterminate" />
      </action>
    </actions>

    <menus>
      <menu name="contextmenu">
        <item action="connect" />
        <item action="disconnect" />
        <item action="terminate" />
      </menu>
    </menus>

    <body>
      <split type="horizontal">
        <part width="1pr">
          <list name="processlist" borders="top left bottom" onselect="gotselectprocess" selectmode="single">
            <column name="processcode" type="integer64" width="6x" />
            <column name="clientname" type="text" />
          </list>
        </part>
        <part width="2pr">
          <list name="joblist"
                borders="top right bottom"
                flags="canconnect candisconnect canterminate"
                onselect="gotselectjob"
                openaction="connect"
                selectcontextmenu="contextmenu"
                selectmode="single"
                sortcolumn="creationdate">
            <column name="groupid" type="text" width="25x" />
            <column name="scriptshow" type="text" width="3pr" tid=".script" />
            <column name="status" type="text" />
            <column name="creationdate" type="datetime" width="21x" precision="milliseconds" storeutc="true" />
            <column name="cpu" type="money" width="8x" align="right" decimals="1" round="true" />
          </list>
        </part>
      </split>
    </body>

    <footer>
      <line>
        <checkbox name="autobreakjob" labeltid=".autobreakjob" title="" value="true" />
        <checkbox name="displayerrorterminated"
                  labeltid=".displayerrorterminated"
                  onchange="gotdisplayerrorterminatedchange"
                  title=""
                  value="false" />
        <spacer width="1pr" />
        <button action="connect" />
        <button tid="~cancel" tolliumresult="cancel" />
      </line>
    </footer>
  </screen>

  <screen name="ruleconnector" width="120x" height="45x" allowresize="true" gid=".ruleconnector" onunload="gotunload">
    <actions>
      <action name="connect" onexecute="doconnect">
        <enableon source="matches" min="1" max="1" />
      </action>
      <action name="activate" onexecute="doactivate" />
      <action name="activateautoconnect" onexecute="doactivateautoconnect" />
      <action name="deactivate" enabled="false" onexecute="dodeactivate" />
    </actions>

    <compositions>
      <radiogroup name="scripttype" onchange="onscripttypeselect" />
      <radiogroup name="user" />
    </compositions>

    <body>
      <grid>
        <col />
        <col />
        <row>
          <cell>
            <line>
              <radiobutton name="scripttype_script"
                           group="scripttype"
                           labeltid=".type_script"
                           rowkey="script"
                           tid=".scripttype" />
              <radiobutton name="scripttype_tolliumapp"
                           group="scripttype"
                           labeltid=".type_tolliumapp"
                           rowkey="tolliumapp"
                           title="" />
            </line>
            <textedit name="scriptmask" defaultbutton="activatebutton" required="true" value="*application*" />
            <textedit name="scriptexcludemasks" defaultbutton="activatebutton" />
            <combobox name="appname" required="true" tid=".app" />
            <line>
              <radiobutton name="user_all" group="user" labeltid=".user_all" rowkey="all" tid=".user" />
              <radiobutton name="user_me" group="user" labeltid=".user_me" rowkey="me" title="" />
            </line>
          </cell>
          <cell>
            <checkbox name="site_start" labeltid=".site_start" title="" />
            <checkbox name="site_terminate" labeltid=".site_terminate" title="" />
            <checkbox name="site_terminateerrors" labeltid=".site_terminateerrors" title="" />
            <checkbox name="site_authenticationrecord" labeltid=".site_authenticationrecord" title="" />
            <checkbox name="site_debuggertrap" labeltid=".site_debuggertrap" title="" />
          </cell>
        </row>
      </grid>
      <line layout="right">
        <button name="activatebutton" action="activate" tid=".activate" />
        <button name="activateautoconnectbutton" action="activateautoconnect" tid=".activateautoconnect" />
        <button action="deactivate" tid=".deactivate" />
      </line>
      <panel height="1pr">
        <list name="matches"
              height="1pr"
              emptytid=".notactive"
              onselect="onjobselect"
              openaction="connect"
              rowkeytype="string"
              selectmode="single">
          <column name="groupid" type="text" width="25x" />
          <column name="scriptshow" type="text" width="3pr" tid=".script" />
          <column name="status" type="text" />
          <column name="creationdate" type="datetime" width="21x" precision="milliseconds" storeutc="true" />
        </list>
      </panel>
      <heading tid=".details" />
      <text name="script" />
      <text name="app" />
      <text name="url" />
    </body>

    <footer>
      <grid>
        <col width="1pr" />
        <col />
        <row>
          <cell layout="left">
            <line>
              <checkbox name="autobreakjob" labeltid=".autobreakjob" onchange="onautobreakjobchange" title="" value="true" />
            </line>
          </cell>
          <cell>
            <line layout="right">
              <button action="connect" />
              <button tid="~close" tolliumresult="close" />
            </line>
          </cell>
        </row>
      </grid>
    </footer>
  </screen>

  <screen name="debugconfig" footerbuttons="ok cancel" tid=".debugconfig">
    <body>
      <line>
        <textedit name="zombietimeout" valuetype="integer" />
        <text valuetid=".zombietimeoutinfo" />  <!-- seconds, 0 to disable -->
      </line>
    </body>
  </screen>

  <screen name="symbolsearch" width="90x" height="30x" allowresize="true" gid=".symbolsearch" tid=".symbolsearch">
    <actions>
      <action name="open" onexecute="doopen">
        <enableon source="results" min="1" />
      </action>
    </actions>

    <body>
      <textedit name="searchfor" width="1pr" defaultbutton="openbutton" onchange="gotsearchforchange" />
      <list name="results" openaction="open" rowlayout="tworows" selectmode="single">
        <column name="definition" type="text" width="3pr" />
        <column name="path" type="text" />
        <column name="type" type="text" width="1pr" align="right" />
        <column name="position" type="text" width="10x" align="right" tid=".type" />
        <rowlayout name="tworows">
          <col coldef="definition" />
          <col coldef="type" combinewithnext="true" />
          <col coldef="position" />
          <row>
            <cell coldef="definition" />
            <cell coldef="type" colspan="2" />
          </row>
          <row>
            <cell coldef="path" colspan="2" />
            <cell coldef="position" />
          </row>
        </rowlayout>
      </list>
    </body>

    <footer>
      <line layout="right">
        <button name="openbutton" action="open" tid=".open" />
        <button tid="~close" tolliumresult="close" />
      </line>
    </footer>
  </screen>

  <screen name="variabletext" width="100x" height="40x">
    <body>
      <codeedit name="text" height="1pr" enabled="false" />
    </body>

    <footer>
      <grid>
        <col width="1pr" />
        <col />
        <row>
          <cell>
            <line>
              <select name="mode" type="pulldown" onchange="gotmodechange">
                <option rowkey="rawtext" />
                <option rowkey="base16" />
                <option rowkey="base64" />
                <option rowkey="hexdump" />
              </select>
              <text name="len" />
            </line>
          </cell>
          <cell>
            <defaultformbuttons buttons="close" />
          </cell>
        </row>
      </grid>
    </footer>
  </screen>

  <screen name="erroroutput" width="100x" height="40x" footerbuttons="close">
    <body>
      <codeedit name="errortext" height="1pr" enabled="false" />
    </body>
  </screen>

</screens>
