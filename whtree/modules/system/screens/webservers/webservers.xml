<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         xmlns:p="http://www.webhare.net/xmlns/publisher/components"
         lib="screens/webservers/webservers.whlib"
         gid="webservers.webservers">

  <messageboxes gid="sysmgmt.webservers.messages">
    <messagebox name="deleteselection" icon="question" buttons="yes no" />
    <messagebox name="deletewebserver" icon="question" buttons="yes no" />
    <messagebox name="deletealias" icon="question" buttons="yes no" />
    <messagebox name="cannotdeleteyourserver" icon="error" buttons="ok" />
    <messagebox name="cannotdeleteprimaryinterface" icon="error" buttons="ok" />
    <messagebox name="deletegroup" icon="question" buttons="yes no" />
    <messagebox name="verifydeletefilledgroup" icon="warning" buttons="yes no" />
    <messagebox name="checkingwebservers" buttons="ok" />
  </messageboxes>

  <screen name="main" gid="sysmgmt.webservers.overview" tid=".title" width="120x" height="30x" allowresize="true" savestate="size" menubar="menubar" icon="tollium:objects/rackserver" flags="issysop">
    <actions>
<!--      <action name="addgroup"     onexecute="@notimplemented" /> -->
      <action name="addwebserver" onexecute="doaddwebserver">
      </action>
      <action name="addgroup" onexecute="doaddgroup">
      </action>
      <action name="addalias" onexecute="doaddalias">
        <enableon source="webserverslist" min="1" max="1" checkflags="isvhosted" />
      </action>
      <action name="edit" onexecute="doedit" tid="tollium:common.actions.edit">
        <enableon source="webserverslist" min="1" max="1" checkflags="!isroot" />
      </action>
      <action name="delete" onexecute="dodelete" tid="tollium:common.actions.delete">
        <enableon source="webserverslist" min="1" checkflags="!isroot" />
      </action>
      <action name="accessrules" onexecute="doaccessrules">
        <enableon source="webserverslist" min="1" max="1" checkflags="ishosted"/>
      </action>
      <windowopenaction name="preview" onwindowopen="dopreview">
        <enableon source="webserverslist" min="1" max="1" checkflags="canview" />
      </windowopenaction>
      <action name="bindings" onexecute="dobindings" frameflags="issysop"/>
      <action name="proxies" onexecute="doproxies" frameflags="issysop" />
      <action name="filetypes" onexecute="dofiletypes" />
      <action name="keystore" onexecute="dokeystore" />
      <action name="exportusagestats" onexecute="doexportusagestats" />
      <action name="schedulecheck" onexecute="doschedulecheck" />
      <action name="certbotrequest" onexecute="docertbotrequest" />
    </actions>
    <menus>
      <menu name="menubar">
        <item name="addchoice" tid="tollium:common.actions.add">
          <item action="addwebserver" />
          <item action="addgroup" />
          <item action="addalias" />
        </item>
        <item action="edit"/>
        <divider />
        <item action="accessrules"/>
        <item action="exportusagestats" />
        <divider />
        <item action="certbotrequest" />
        <item action="schedulecheck" />
        <divider />
        <item action="delete"/>
      </menu>
      <menu name="sel">
        <item name="add" tid="tollium:common.actions.add">
          <item action="addwebserver" disablemode="hidden"/>
          <item action="addgroup" disablemode="hidden"/>
          <item action="addalias" disablemode="hidden"/>
        </item>
        <item action="edit" disablemode="hidden"/>
        <divider />
        <item action="accessrules" disablemode="hidden"/>
        <divider />
        <item action="delete" disablemode="hidden"/>
      </menu>
      <menu name="nosel">
        <item tid="tollium:common.actions.add">
          <item action="addwebserver" disablemode="hidden"/>
          <item action="addgroup" disablemode="hidden"/>
        </item>
      </menu>
    </menus>

    <compositions>
      <eventlistener masks="system:internal.checkwebservers" onevent="onerrorsrefresh" />
    </compositions>

    <toolbar>
      <button menu="addchoice" icon="tollium:actions/add" tid="tollium:common.actions.add"/>
      <button action="edit" icon="tollium:actions/edit" />
      <button action="delete"  icon="tollium:actions/delete" />
      <divider/>
      <button action="preview" icon="tollium:filemgr/previewsite" />
      <button action="accessrules" icon="system:sysmgmt/access" />
      <divider/>
      <button action="bindings" icon="system:sysmgmt/port" />
      <button action="keystore" icon="tollium:security/key"/>
      <button action="filetypes" icon="tollium:files/application_x-webhare-unknown" />
      <button action="proxies" icon="tollium:actions/meredians" />
    </toolbar>

    <body height="1pr">
      <line>
        <textedit name="filter" onchange="onfilterchange" />
      </line>
      <panel height="1pr">
        <list name="webserverslist"
              height="1pr"
              gid=".columns"
              selectcontextmenu="sel"
              newcontextmenu="nosel"
              openaction="edit"
              selectmode="multiple"
              savestate="expanded"
              highlightname="iscurwebserver"
              icons="tollium:folders/outputserver
                     tollium:folders/webhareserver
                     tollium:folders/externalserver
                     tollium:folders/websitealias
                     sysmgmt/webservergroup
                     tollium:folders/redirectsite
                     tollium:status/warning
                     tollium:folders/serveraccessrules"
              flags="isroot ishosted isvhosted isalias iswebserver isgroup canview">

          <acceptdrops ondrop="ondrop">
            <accepttype type="local:webserver" targetflags="isgroup" dropeffects="move" requiretarget="1" noloops="true" />
            <accepttype type="local:webserver" targetflags="isroot" dropeffects="move" requiretarget="1" noloops="true" />
            <accepttype type="local:webserveralias" targetflags="iswebserver" dropeffects="move" requiretarget="1" />
          </acceptdrops>

          <column type="text" width="3pr" name="webserver" tree="true" iconname="icon" />
          <column type="icon" width="24px" name="status" hintname="statusmessage" title="" />
          <column type="text" width="3pr" name="path" />
          <column type="text" width="10x" name="sites" align="right" />
          <column type="text" width="10x" name="rules" align="right" />

        </list>
      </panel>
    </body>
  </screen>

  <screen name="updatewebserver" gid="sysmgmt.webservers.updatewebserver"
          minwidth="80x"
          >
    <body width="1pr" height="1pr" spacers="none">
      <panel name="versioningmessagesbox" backgroundcolor="#FEFFDE" visible="false" spacers="left right" borders="bottom">
        <text title="" valuetid=".urllockedforversioning" wordwrap="true" width="1pr" />
      </panel>

      <panel spacers="all">
        <select name="servertype" type="radio" rowkeytype="integer" onchange="onservertypechange">
          <option rowkey="0" tid="sysmgmt.webservers.types.webhare_output" />
          <option rowkey="-1" tid="sysmgmt.webservers.types.webhare_rulesonly" />
          <option rowkey="1" tid="sysmgmt.webservers.types.webhare_interface" />
        </select>
        <select name="boundto" type="pulldown" rowkeytype="integer" onchange="onbindingchange" />
        <textedit name="url" required="true" validationchecks="http-url" placeholder="https://www.example.org/" maxlength="256" width="1pr"/>
        <select type="pulldown" rowkeytype="integer" name="stricttransportsecurity">
          <option rowkey="0" />
          <option rowkey="900" />
          <option rowkey="86400" />
          <option rowkey="2592000" />
          <option rowkey="7776000" />
          <option rowkey="31536000" selected="true"/> <!-- 1 year, default -->
          <option rowkey="63072000" />
        </select>
        <browseserverpath name="folder" acceptfiles="false" allowmanualedit="true" width="1pr" />
        <select type="pulldown" rowkeytype="string" name="extension" required="true">
          <option rowkey=".html" title=".html"/>
          <option rowkey=".shtml" title=".shtml"/>
        </select>
      </panel>
    </body>
    <footer>
      <defaultformbuttons buttons="ok cancel" />
    </footer>
  </screen>

  <screen name="webservergroup" gid="sysmgmt.webservers.webservergroup">
    <body width="1pr" height="1pr">
      <panel height="1pr">
        <textedit name="title" required="true" />
      </panel>
    </body>
    <footer>
      <defaultformbuttons buttons="ok cancel"/>
    </footer>
  </screen>

  <screen name="updatealias" gid="sysmgmt.webservers.updatealias" tid=".title">
    <body>
      <panel height="1pr">
        <textedit name="hostname" required="true" />
        <select name="explicit" type="radio" rowkeytype="boolean">
          <option rowkey="false" selected="true" />
          <option rowkey="true" />
        </select>
      </panel>
    </body>
    <footer>
      <defaultformbuttons buttons="ok cancel"/>
    </footer>
  </screen>

  <screen name="exportusagestats" gid=".exportusagestats">
    <actions>
      <downloadaction name="export" ondownload="doexport" tid="tollium:common.actions.export" />
    </actions>
    <body>
      <date name="startdate" required="true"/>
      <date name="enddate" required="true" />
    </body>
    <footer>
      <line layout="right">
        <button action="export" />
        <button tid="tollium:common.actions.close" tolliumresult="close" />
      </line>
    </footer>
  </screen>

  <screen name="certbotrequest" allowresize="true" height="15x" width="60x" gid=".certbotrequest" defaultbutton="requestbutton">
    <actions>
      <action name="request" onexecute="dorequest" />
    </actions>
    <body>
      <textarea name="domainnames" placeholdertid=".domainnames-placeholder" height="1pr" required="true"/>
    </body>
    <footer>
      <line layout="right">
        <button action="request" name="requestbutton" tid=".request" />
        <button tolliumresult="close" tid="~close" />
      </line>
    </footer>
  </screen>

</screens>
