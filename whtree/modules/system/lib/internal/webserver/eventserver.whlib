<?wh
PUBLIC STRING FUNCTION GetEventServerToken(STRING groupid, BOOLEAN write)
{
  INTEGER ARRAY buffer := write
      ? [ 87, 82, 73, 84, 53, 50, 52, 53 ] // 'WRIT5245';
      : [ 82, 69, 65, 68, 49, 42, 51, 50 ]; // 'READ1*32'

  FOR (INTEGER i := 0, e := LENGTH(groupid); i < e; i := i + 1)
    buffer[i%8] := buffer[i%8] BITXOR GetByteValue(SubString(groupid, i, 1));

  STRING result;
  FOR (INTEGER i := 0; i < 8; i := i + 1)
    result := result || Right("0" || ToString(buffer[i], 16), 2);
  RETURN result;
}
