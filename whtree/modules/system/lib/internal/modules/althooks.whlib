<?wh
LOADLIB "wh::devsupport.whlib";

LOADLIB "mod::system/lib/resources.whlib";

///The hookable variant also supports non-harescript languages as long as an external librarysystem hook implements it
PUBLIC RECORD FUNCTION HookableDescribeCompiledLibrary(STRING libname)
{
  RECORD hookresult := RunModuleHookTarget("system:librarysystem", CELL[ task := "DescribeCompiledLibrary", libname, libinfo := DEFAULT RECORD ]);
  IF(RecordExists(hookresult.libinfo))
    RETURN hookresult.libinfo;

  RECORD lib := DescribeCompiledLibrary(libname);
  IF(RecordExists(lib))
    RETURN CELL [ casesensitive := FALSE //external languages might be
                , ...lib
                ];
  ELSE
    RETURN DEFAULT RECORD;
}

PUBLIC RECORD FUNCTION HookableStartTolliumApp(RECORD app, RECORD invoke)
{
  RECORD hookresult := RunModuleHookTarget("system:librarysystem", CELL[ task := "StartTolliumApp", app, invoke, firstmessage := DEFAULT RECORD ]);
  IF(RecordExists(hookresult.firstmessage))
    RETURN hookresult.firstmessage;
  RETURN DEFAULT RECORD;
}
