# 4.34 - 24 Februari 2022

## Incompatibilities and deprecations
- WebHare no longer runs install scripts for npm modules downloaded by fixmodules.
- The WebHare V2 Witty APIs (deprecated since V3) have been removed.
- The undocumented `[repeat]` witty statement has been removed.
- Lists now prefer the colored versions everywhere (icon*s* columns used to prefer the black version where other list icons preferred the color version)
- Modules can no longer be deployed to remote servers from the system:config application - this functionality has moved to the dev module
- Users no longer have implicit browse rights on their parent unit in user management
- Removes support for the old siteprofile `<consilio:index>`, `<consilio:addtoindex>` and `<consilio:contentsource>` syntax.
- `striprtdextension` is now set by default to start a phase-out for the `.rtd` extensions for new files
- `->ScheduleTask` (deprecated since 4.27) will now fail on non-production installations. Replace with %ScheduleManagedTask.
- The `dompack:scrollintoview` event has been removed. You should replace calls to `dompack.scrollIntoView(node,...)` with a
  call to `node.scrollIntoView` and use CSS [scroll-margin](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-margin)
  to solve sticky header covering issues.
- The `wh-anchor` custom styling has been removed. You should set a `scroll-margin-top` (and/or -left) on `.wh-anchor` for
  proper CSS-only scroll positioning when using anchors.
- The `wh-anchor` has been moved inside `.wh-form__fields` in forms to improve its compatibility with flex layouts.
- Consilio search reports have been disabled in the interface. We will still be gathering the data, but we intend to fully
  remove it in the future. We may replace this with a more analytics-like data gathering in the future.
- You will start to receive warnings if you haven't completed the migration to PostgreSQL yet. We're currently considering
  - to announce 4.35 as an 'unskippable upgrade'
  - drop the dbserver in 4.36 and prevent WebHare from starting if it sees a 'dbserver' database. You won't be able to upgrade
    past 4.35 without upgrading your database and will need to go back to 4.35 if you try it anyway.

## Things that are nice to know
- The dialogapi's keyboard capture has been improved to not capture ALL keyboard events (including eg reload) just to prevent
  you from moving focus outside the dialog
- A new Tollium element `<statuspanel>` has been added to wrap showing an info/warning/error at the top of a screen or panel.
- Title field 'seo title' and 'header title' have been added. See [seo-settings.md](https://www.webhare.dev/reference/siteprofiles/seo-settings)
- RunSimpleScreen now supports a `html` option allowing you to pass rich text to dialogs
- Assetpacks no longer create separate `.dev` versions for development. Instead you can enable/disable development mode for assetpacks in the dashboard
- You can configure an external ClamAV virus scanner to scan incoming uploads
- The domain contents used by `GetDomValTitle` etc are now cached in the adhoc-cache (if the attribute's domain is actually of a Domain type)
- Adds `wh debug mark [text]` allowing you to insert a marker text into the log files
- %FormatISO8601Datetime now accepts an options argument to set dateformat, timeformat, timezone and extended.
- `<scheduletimedtask>` now has a `delay=` parameter to coalesce too frequent triggers
- Adds support for a third WRD_GENDER option for "Other/Diverse"
- The whfstool has a new option `--striprtdextension` which removes the `.rtd` extension from files.
  - Example usage: `wh publisher:whfstool --striprtdextension --recursive "site::mysite/myfolder"`
  - striprtdextension will *not* change modification dates or trigger republishes/events (and won't cause eg. the Publisher
    to update its file view). striprtdextension will also ignore the 'pinned' flag or any versioning/review setup.
- %GetConsilioPublisherCatalog makes it easier to find the right catalog for your site if you have a complex configuration
- Catalogs named `consilio:testfw_*` are now intended for tests that use the API (and they don't require activation of the ConsilioTestExtensions to be cleaned up)
- You can use `<urlhistory accesscheck=>` to permit additional users to modify URL history items for a target site. This is
  useful for applications that use the Publisher as their datastore but don't allow users direct write access.
- Tollium `<imgedit>` has added `expectedsize=`, `minsize=` and `recommendedsize=` to specify required/expected dimensions of images

## Things you should do
