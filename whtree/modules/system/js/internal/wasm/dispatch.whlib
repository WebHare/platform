<?wh


PUBLIC STRING FUNCTION Dispatch(FUNCTION PTR tocall, STRING hsondata, BOOLEAN isfunction)
{
  TRY
  {
    RECORD data := DecodeHSON(hsondata);
    IF(isfunction)
      RETURN EncodeHSON(
          [ type := "result"
          , value := CallFunctionPtrVA(tocall, data.params)
          ]);

    CallMacroPtrVA(tocall, data.params);
    RETURN EncodeHSON(
        [ type := "result"
        ]);
  }
  CATCH (OBJECT e)
  {
    RETURN EncodeHSON(
        [ type := "exception"
        , __exception := e->EncodeForIPC()
        ]);
  }
}
