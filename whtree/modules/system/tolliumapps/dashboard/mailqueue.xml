<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         library="mailqueue.whlib"
         gid="tolliumapps.dashboard.mailqueue">

  <messageboxes>
    <messagebox name="confirmrequeuemail" buttons="yes no" />
    <messagebox name="confirmdeletemail" buttons="yes no" />
  </messageboxes>

  <screen name="mailqueuepanel" gid=".panel" title="">
    <actions>
      <action name="new" onexecute="donew" shortcut="ctrl+n" tid="~new" />
      <action name="flush" onexecute="doflush" />

      <action name="requeue" onexecute="dorequeue">
        <enableon source="mailqueue" min="1" checkflags="isfinished" />
      </action>

      <action name="forward" onexecute="doforward">
        <enableon source="mailqueue" min="1" />
      </action>

      <action name="viewmessage" onexecute="doviewmessage" tid="~view">
        <enableon source="mailqueue" min="1" max="1" />
      </action>
      <action name="delete" onexecute="dodelete" shortcut="del" tid="~delete">
        <enableon source="mailqueue" min="1" />
      </action>
      <action name="result" onexecute="doresult">
        <enableon source="mailqueue" min="1" max="1" checkflags="hasresult" />
      </action>
    </actions>

    <menus>
      <menu name="email_menu">
        <item action="viewmessage"/>
        <item action="forward"/>
        <item action="requeue" disablemode="hidden"/>
        <item action="result" />
        <item action="delete" disablemode="hidden" />
      </menu>

      <menu name="queue_menu">
        <item action="flush"/>
        <item action="new"/>
      </menu>
    </menus>

    <compositions>
      <eventlistener name="listener" masks="system:managedtasks.system:outgoingmail.*" onevents="onmanagedtaskevent" />
    </compositions>

    <body height="1pr">
      <grid height="1pr">
        <col width="1pr" />
        <col />
        <row height='1pr'>
          <cell>
            <panel height="1pr">
              <list name="mailqueue"
                    icons="tollium:status/wait tollium:status/error tollium:status/checked tollium:status/not_available"
                    selectmode="multiple"
                    selectcontextmenu="email_menu"
                    newcontextmenu="queue_menu"
                    sortcolumn="creationdate"
                    openaction="viewmessage"
                    width="1pr"
                    height="1pr"
                    sortascending="false"
                    flags="isfinished hasresult"
                    borders="right bottom"
                    >
                <column type="datetime" name="creationdate" storeutc="true" width="18x" precision="seconds" />
                <column type="text"     name="sender" />
                <column type="text"     name="subject" tid="~subject" />
                <column type="text"     name="receiver" />
                <column type="icon"     name="status" align="center" width="7x" tid="~status" />
                <column type="datetime" name="nextattempt" storeutc="true" width="16x" precision="seconds" />
              </list>
            </panel>
          </cell>
          <cell spacers="left right" layout="left">
            <textedit name="filter" onchange="RefreshDashboardPanel" width="1pr" />
            <checkbox name="showsentmail" onchange="RefreshDashboardPanel" title="" labeltid=".showsentmail" />
            <checkbox name="showscheduledmail" onchange="RefreshDashboardPanel" title="" labeltid=".showscheduledmail" />
            <button width="1pr" name="newbutton" action="new" tid="~new" />
            <button width="1pr" name="flushbutton" action="flush" tid=".flush" />
            <button width="1pr" action="forward"             />
            <button width="1pr" action="viewmessage" />
            <button width="1pr" action="result"  />
            <button width="1pr" name="deletebutton" action="delete" tid="~delete"  />
          </cell>
        </row>
      </grid>
    </body>
  </screen>

  <screen name="result" gid=".result">
    <body>
      <text name="serverip" />
      <text name="route" />
      <text name="response" />
      <text name="sender" />
      <text name="finalreceiver" />
      <text name="lasterror" />
    </body>
    <footer>
      <defaultformbuttons buttons="close" />
    </footer>
  </screen>
</screens>
