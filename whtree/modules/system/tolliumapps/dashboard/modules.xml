<screens xmlns="http://www.webhare.net/xmlns/tollium/screens" gid="tolliumapps.dashboard.modules" library="modules.whlib">

  <screen name="modulespanel" allowresize="true">
    <actions>
      <uploadaction name="uploadmodule" onupload="douploadmodule" tid="~upload" />
      <action name="deletemodule" onexecute="dodeletemodule" tid="~delete">
        <enableon source="modules" min="1" max="1" checkflags="candelete" />
      </action>
      <action name="versions" onexecute="doversions">
        <enableon source="modules" min="1" max="1" checkflags="canseeversions" />
      </action>
      <action name="configuremodule" onexecute="doconfigmodule">
        <enableon source="modules" min="1" max="1" checkflags="isconfigurable" />
      </action>
      <windowopenaction name="openwebsite" onwindowopen="onopenwebsite">
        <enableon source="modules" min="1" max="1" checkflags="havewebsite" />
      </windowopenaction>
    </actions>

    <menus>
      <menu name="noselection_modules">
        <item action="uploadmodule" />
      </menu>
      <menu name="selection_modules">
        <item action="openwebsite" />
        <divider />
        <item action="versions" />
        <item action="configuremodule" />
        <divider />
        <item action="deletemodule" />
      </menu>
    </menus>

    <compositions>
      <eventlistener name="giteventlistener"
                     groupinterval="1000"
                     masks="system:modulefolder.mod::*/.git/*"
                     onevents="GotGitEvent" />
      <eventlistener name="moduleeventlistener"
                     groupinterval="1000"
                     masks="system:softreset system:modulesupdate"
                     onevents="GotModuleEvent" />
    </compositions>

    <body height="1pr" spacers="none">
      <panel backgroundcolor="#f0f0f0" spacers="left right" borders="bottom">
        <line layout="tabs-space">
          <select name="showdeleted" type="pulldown" onchange="onshowdeletedchange" rowkeytype="boolean" title="">
            <option rowkey="false" tid=".dontshowdeleted" />
            <option rowkey="true" tid=".showdeleted" />
          </select>
          <spacer />
          <text name="localheading" title="" value="" />
        </line>
      </panel>
      <grid height="1pr">
        <cell width="1pr">
          <list name="modules"
                height="1pr"
                borders="right"
                flags="candelete canseeversions isavailable isconfigurable havewebsite"
                icons="tollium:files/text_plain
                       tollium:objects/webhare
                       tollium:tollium/tollium
                       tollium:status/versioned
                       tollium:objects/cog"
                newcontextmenu="noselection_modules"
                ongetrows="getmodules"
                openaction="configuremodule"
                selectcontextmenu="selection_modules"
                selectmode="single"
                sortcolumn="name">
            <column name="name" type="text" width="1pr" iconname="typeicon" />
            <column name="configicon" type="icon" width="16px" title="" />
            <column name="version" type="text" width="16x" align="right" />
            <column name="revision" type="text" width="1pr" />
            <column name="description" type="text" width="3pr" tid="~description" />
            <column name="lastmodified" type="datetime" width="16x" precision="minutes" storeutc="true" />
            <style name="deleted" textcolor="#AAAAAA" />
          </list>
        </cell>
        <cell spacers="left top right">
          <button action="configuremodule" />
          <button action="uploadmodule" />
          <button action="deletemodule" />
          <spacer height="1gr" />
          <button action="versions" />
          <button action="openwebsite" />
        </cell>
      </grid>
    </body>
  </screen>

  <screen name="moduleversions"
          minwidth="100x"
          minheight="20x"
          allowresize="true"
          gid=".moduleversions"
          savestate="position size"
          title="">
    <actions>
      <action name="hotfixes" onexecute="dohotfixes">
        <enableon source="versions" min="1" max="1" />
      </action>
    </actions>

    <body height="1pr" layout="form">
      <grid height="1pr">
        <col width="1pr" />
        <col width="1x" />
        <row height="1pr">
          <cell>
            <panel height="1pr">
              <list name="versions" height="1pr" selectmode="single" sortascending="false">
                <column name="uploaddate"
                        type="datetime"
                        width="16x"
                        precision="minutes"
                        sortkeyname="orderdate"
                        storeutc="true" />
                <column name="archived" type="text" width="8x" />
                <column name="obsoletiondate" type="datetime" width="16x" precision="minutes" storeutc="true" />
                <column name="version" type="text" width="10x" />
                <column name="revision" type="text" width="10x" />
                <column name="description" type="text" width="1pr" tid="~description" />
              </list>
            </panel>
          </cell>
          <cell>
            <button width="1pr" action="hotfixes" />
          </cell>
        </row>
      </grid>
    </body>

    <footer>
      <line layout="right">
        <button tid="~close" tolliumresult="cancel" />
      </line>
    </footer>
  </screen>

  <screen name="moduleinfo"
          minwidth="100x"
          minheight="40x"
          allowresize="true"
          footerbuttons="close"
          gid=".moduleinfo"
          savestate="size">
    <body>
      <split type="vertical">
        <part height="2pr">
          <text name="sourcerepositoryurl" visible="false" />
          <text name="sourcerepositoryuuid" visible="false" />
          <text name="sourcerevision" visible="false" />
          <panel height="1pr">
            <list name="changesets" borders="top right left" onselect="onchangesetselect" selectmode="single">
              <column name="date" type="datetime" precision="minutes" storeutc="true" />
              <column name="server" type="text" />
              <column name="userfullname" type="text" />
              <column name="source" type="text" />
            </list>
          </panel>
        </part>
        <part height="1pr" minheight="10x">
          <text tid=".modifiedfiles" />
          <panel height="1pr">
            <list name="modifications" selectmode="single">
              <column name="path" type="text" />
              <column name="status" type="text" />
            </list>
          </panel>
        </part>
      </split>
    </body>
  </screen>

</screens>
