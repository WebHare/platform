<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         gid="tolliumapps.config.mailrouting"
         library="mailrouting.whlib">

  <screen name="mailconfig" footerbuttons="ok cancel">
    <body>
      <heading tid=".defaultsendsettings" />
      <textedit name="hostname" width="1pr" required="true" />
      <line>
        <textedit name="port" width="6x" required="true" valuetype="integer" />
        <text valuetid=".defaultport" />
      </line>
      <textedit name="authusername" tid="~username" />
      <textedit name="authpassword" password="true" tid="~password" />
      <heading tid=".fallbackvalues" />
      <textedit name="mailfrom" required="true" validationchecks="email-maysendfrom" />
      <line layout="left">
        <checkbox name="usefornonwhitelisted" labeltid=".usefornonwhitelisted" title="" />
      </line>
    </body>
  </screen>

  <screen name="editsmtpserver" width="50x" footerbuttons="ok cancel">
    <body>
      <!-- heading tid=".heading_smtpserver" -->
      <textedit name="hostname" width="1pr" required="true" />
      <line>
        <textedit name="port" width="6x" required="true" value="25" valuetype="integer" />
        <text valuetid=".defaultport" />
      </line>
      <textedit name="authusername" tid="~username" />
      <textedit name="authpassword" password="true" tid="~password" />
    </body>
  </screen>

  <screen name="mailroutes" width="130x" height="40x" allowresize="true" footerbuttons="close">
    <actions>
      <action name="mailconfig" onexecute="domailconfig" />
    </actions>

    <body spacers="none">
      <tabs height="1pr">
        <tab name="routestab">
          <heading tid=".smtpconfig" />
          <line>
            <textedit name="smtpserver" width="1pr" enabled="false" />
            <button action="mailconfig" />
          </line>
          <textedit name="snsendpoint" width="1pr" enabled="false" />
          <hr />
          <heading tid=".mailroutes" />
          <listedit name="routes"
                    height="1pr"
                    emptytid=".routesempty"
                    eventmasks="system:internal/mailroutechange"
                    onchangeorder="onchangeorder"
                    ongetrows="ongetroutes"
                    onrowdelete="ondeletemailroute"
                    onrowedit="oneditmailroute">
            <column name="description" type="text" width="2pr" tid="~description" />
            <column name="sendermaskcomma" type="text" width="2pr" hintname="sendermaskhint" tid=".sendermask" />  <!-- sender (from) masks -->
            <column name="maskcomma" type="text" width="2pr" hintname="maskhint" tid=".mask" />  <!-- receivers (to) masks -->
            <column name="outgoingmailaddress" type="text" width="2pr" />  <!-- redirect all mails to: -->
            <column name="altserver" type="text" width="2pr" />
          </listedit>
        </tab>
        <tab name="senderstab">
          <listedit name="senders"
                    height="1pr"
                    emptytid=".sendersempty"
                    eventmasks="system:internal/mailroutechange"
                    ongetrows="ongetsenders"
                    onrowdelete="ondeletesender"
                    onrowedit="oneditsender">
            <column name="mask" type="text" width="1pr" tid=".mask" />
            <column name="description" type="text" width="2pr" tid="~description" />
          </listedit>
        </tab>
        <tab name="receiverstab">
          <listedit name="receivers"
                    height="1pr"
                    emptytid=".receiversempty"
                    eventmasks="system:internal/mailroutechange"
                    ongetrows="ongetreceivers"
                    onrowdelete="ondeletereceiver"
                    onrowedit="oneditreceiver">
            <column name="mask" type="text" width="1pr" tid=".mask" />
            <column name="description" type="text" width="2pr" tid="~description" />
          </listedit>
        </tab>
        <tab name="emailcorrectionstab">
          <listedit name="emailcorrections"
                    height="1pr"
                    emptytid=".correctionsempty"
                    eventmasks="system:internal/mailroutechange"
                    onchangeorder="onchangeorder"
                    ongetrows="ongetcorrections"
                    onrowdelete="ondeletecorrection"
                    onrowedit="oneditcorrection">
            <column name="description" type="text" width="2pr" tid="~description" />
            <column name="maskcomma" type="text" width="2pr" hintname="maskhint" tid=".mask" />  <!-- receivers (to) masks -->
            <column name="target" type="text" width="2pr" />  <!-- redirect all mails to: -->
          </listedit>
        </tab>
      </tabs>
    </body>
  </screen>

  <screen name="editmailroute" width="70x" minwidth="60x" allowresize="true" footerbuttons="ok cancel">
    <actions>
      <action name="editsmtpserver" onexecute="doeditsmtpserver" title="" />
    </actions>

    <compositions>
      <radiogroup name="usealternativesmtpserver" onchange="gotsmtpserverchange" />
    </compositions>

    <body>
      <textedit name="description" width="1pr" required="true" tid="~description" />
      <textedit name="tag" width="1pr" tid="~tag" />
      <textedit name="originmask" width="1pr" />
      <heading tid=".masks_from" />
      <arrayedit name="masks_from"
                 height="1pr"
                 minwidth="50x"
                 minheight="3x"
                 columnheaders="false"
                 errorlabeltid=".masks_from"
                 minrows="1"
                 onrowedit="doeditmailrouterule_from">
        <!-- ADDME: oncelledit="oncelledit" -->
        <column name="mask" type="text" width="1pr" />
      </arrayedit>
      <heading tid=".masks_to" />
      <arrayedit name="masks_to"
                 height="1pr"
                 minwidth="50x"
                 minheight="3x"
                 columnheaders="false"
                 errorlabeltid=".masks_to"
                 minrows="1"
                 onrowedit="doeditmailrouterule_to">
        <!-- ADDME: oncelledit="oncelledit" -->
        <column name="mask" type="text" width="1pr" />
      </arrayedit>
      <heading tid=".outgoing" />
      <lines layout="left">
        <radiobutton group="usealternativesmtpserver" labeltid=".usealternativesmtpserver-default" rowkey="default" title="" />
        <line>
          <radiobutton enablecomponents="editserverurl"
                       group="usealternativesmtpserver"
                       labeltid=".usealternativesmtpserver-alternative"
                       rowkey="alternative"
                       title="" />
          <textedit name="serverurl" width="1pr" enabled="false" errorlabeltid=".serverurl" title="" />
          <button name="editserverurl" action="editsmtpserver" tid="~edit" />
        </line>
        <radiobutton group="usealternativesmtpserver"
                     labeltid=".usealternativesmtpserver-dontsend"
                     rowkey="dontsend"
                     title="" />
      </lines>
      <heading tid=".redirect" />
      <lines layout="left">
        <select name="outgoingredirect" type="radio" implicitenablecomponents="false" rowkeytype="boolean" title="">
          <option rowkey="false" />
          <option rowkey="true" enablecomponents="outgoingmailaddress outgoingaddressrewrite">
            <textedit name="outgoingmailaddress"
                      width="1pr"
                      errorlabeltid=".outgoingmailaddress"
                      required="true"
                      title=""
                      validationchecks="email-maysendto" />
          </option>
        </select>
        <checkbox name="outgoingaddressrewrite" labeltid=".outgoingaddressrewrite" title="" />
      </lines>
    </body>
  </screen>

  <screen name="editmailrouterule" width="60x" footerbuttons="ok cancel">
    <compositions>
      <record name="row" />
    </compositions>

    <body>
      <textedit name="mask" width="1pr" required="true" />
    </body>
  </screen>

  <screen name="editmask" footerbuttons="ok cancel">
    <compositions>
      <record name="row" />
    </compositions>

    <body>
      <textedit composition="row" cellname="mask" name="mask" width="1pr" required="true" />
      <textedit composition="row" cellname="description" name="description" width="1pr" tid="~description" />
    </body>
  </screen>

  <screen name="editcorrection" footerbuttons="ok cancel">
    <body>
      <heading tid=".masks" />
      <arrayedit name="masks"
                 height="1pr"
                 minwidth="50x"
                 minheight="3x"
                 columnheaders="false"
                 errorlabeltid=".masks"
                 roweditscreen="#editmaskrow">
        <!-- ADDME: oncelledit="oncelledit" -->
        <column name="mask" type="text" width="1pr" />
      </arrayedit>
      <select name="correctiontype" type="radio">
        <option rowkey="rewrite" enablecomponents="rewriteto suggestionfuzz" />
        <option rowkey="block" />
      </select>
      <textedit name="rewriteto" required="true" />
      <textedit name="suggestionfuzz" valuetype="integer" />
      <textedit name="description" width="1pr" tid="~description" />
    </body>
  </screen>

  <screen name="editmaskrow" footerbuttons="ok cancel" implementation="rowedit">
    <compositions>
      <record name="row" />
    </compositions>

    <body>
      <textedit composition="row" cellname="mask" name="mask" width="1pr" required="true" />
    </body>
  </screen>

</screens>
