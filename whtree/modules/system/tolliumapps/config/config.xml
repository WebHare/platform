<screens xmlns="http://www.webhare.net/xmlns/tollium/screens" gid="tolliumapps.config" library="config.whlib">

  <screen name="main"
          minwidth="150x"
          minheight="30x"
          allowresize="true"
          gid=".main"
          icon="tollium:system/system"
          menubar="menubar"
          onmessage="onmessage"
          onunload="gotunload"
          savestate="size"
          tid="portal.apps.config">
    <actions>
      <action name="refresh" onexecute="dorefresh" tid="~refresh" />
      <uploadaction name="uploadmodule" onupload="douploadmodule" tid="~upload" />
      <action name="deletemodule" onexecute="dodeletemodule" tid="~delete">
        <enableon source="modules" min="1" max="1" checkflags="canmanage" />
      </action>
      <action name="versions" onexecute="doversions">
        <enableon source="modules" min="1" max="1" checkflags="canseeversions" />
      </action>
      <action name="configuremodule" onexecute="doconfigmodule">
        <enableon source="modules" min="1" max="1" checkflags="isconfigurable" />
      </action>
      <action name="editreg" onexecute="doeditreg" tid="sysmgmt.registry.title" />
      <action name="adhoccache" onexecute="doadhoccache" tid="sysmgmt.adhoccache.title" />
      <action name="remoting" onexecute="doremoting" tid="sysmgmt.remoting.title" />
      <action name="backend" onexecute="dobackend" shortcut="ctrl+shift+t" tid="tolliumapps.config.settings.settings" />
      <action name="webdavdata" onexecute="dowebdavdata" tid="sysmgmt.webdav.data.title" />
      <action name="scheduler" onexecute="doscheduler" tid="sysmgmt.scheduler.title" />
      <action name="mailroutes"
              onexecute="domailroutes"
              shortcut="ctrl+shift+e"
              tid="tolliumapps.config.mailrouting.mailroutes" />
      <action name="apprunner" onexecute="doapprunner" tid="sysmgmt.apprunner.title" />
      <windowopenaction name="openwebsite" onwindowopen="onopenwebsite">
        <enableon source="modules" min="1" max="1" checkflags="havewebsite" />
      </windowopenaction>
      <action name="close" onexecute="DoClose" tid="~exit" />
    </actions>

    <menus>
      <menu name="menubar">
        <item action="uploadmodule" />
        <item action="openwebsite" />
        <divider />
        <item action="backend" />
        <item action="editreg" />
        <item action="adhoccache" />
        <item action="remoting" />
        <item action="apprunner" />
        <item action="scheduler" />
        <item action="webdavdata" />
        <item action="mailroutes" />
        <divider />
        <item action="versions" />
        <item action="configuremodule" />
        <divider />
        <item action="refresh" />
        <item action="close" />
      </menu>
      <menu name="noselection_modules">
        <item action="uploadmodule" />
      </menu>
      <menu name="selection_modules">
        <item action="openwebsite" />
        <divider />
        <item action="versions" />
        <item action="configuremodule" />
        <divider />
        <item action="deletemodule" />
      </menu>
    </menus>

    <compositions>
      <eventlistener name="giteventlistener"
                     groupinterval="1000"
                     masks="system:modulefolder.mod::*/.git/*"
                     onevents="GotGitEvent" />
      <eventlistener name="moduleeventlistener"
                     groupinterval="1000"
                     masks="system:softreset system:moduleupdate"
                     onevents="GotModuleEvent" />
    </compositions>

    <toolbar>
      <button action="configuremodule" icon="tollium:objects/cog" />
      <divider />
      <button action="uploadmodule" icon="tollium:actions/upload" />
      <button action="versions" icon="tollium:actions/history" />
      <divider />
      <button action="mailroutes" icon="tollium:system/emailrouting" />
    </toolbar>

    <body height="1pr" spacers="none">
      <panel backgroundcolor="#f0f0f0" spacers="left right">
        <line layout="tabs-space">
          <select name="showdeleted" type="pulldown" onchange="onshowdeletedchange" rowkeytype="boolean" title="">
            <option rowkey="false" tid=".dontshowdeleted" />
            <option rowkey="true" tid=".showdeleted" />
          </select>
          <spacer />
          <text name="localheading" title="" value="" />
        </line>
      </panel>
      <panel height="1pr">
        <list name="modules"
              height="1pr"
              borders="top bottom"
              flags="canmanage canseeversions isavailable isconfigurable havewebsite"
              icons="tollium:files/text_plain
                     tollium:objects/webhare
                     tollium:tollium/tollium
                     tollium:status/versioned
                     tollium:objects/cog"
              newcontextmenu="noselection_modules"
              ongetrows="getmodules"
              openaction="configuremodule"
              selectcontextmenu="selection_modules"
              selectmode="single"
              sortcolumn="name">
          <column name="name" type="text" width="1pr" iconname="typeicon" />
          <column name="configicon" type="icon" width="16px" title="" />
          <column name="version" type="text" width="16x" align="right" />
          <column name="revision" type="text" width="1pr" />
          <column name="description" type="text" width="3pr" tid="~description" />
          <column name="lastmodified" type="datetime" width="16x" precision="minutes" storeutc="true" />
          <style name="deleted" textcolor="#AAAAAA" />
        </list>
      </panel>
    </body>
  </screen>

</screens>
