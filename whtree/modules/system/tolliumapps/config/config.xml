<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         library="config.whlib"
         gid="tolliumapps.config"
         >
  <screen name="main"
          minwidth="150x"
          minheight="30x"
          allowresize="true"
          savestate="size"
          menubar="menubar"
          icon="tollium:system/system"
          flags="developer
          connected"
          gid=".main"
          tid="portal.apps.config"
          onmessage="onmessage"
          onunload="gotunload">
    <actions>
      <action name="refresh" onexecute="dorefresh" tid="~refresh"/>
      <uploadaction name="uploadmodule" onupload="douploadmodule" tid="~upload"/>
      <!--
      <action name="removemodule" onexecute="doremovemodule">
        <enableon source="modules" min="1" />
      </action>
      -->
      <action name="deletemodule" tid="~delete" onexecute="dodeletemodule">
        <enableon source="modules" min="1" max="1" checkflags="canmanage" />
      </action>
      <action name="versions" onexecute="doversions">
        <enableon source="modules" min="1" max="1" checkflags="canseeversions" />
      </action>
      <action name="configuremodule" onexecute="doconfigmodule">
        <enableon source="modules" min="1" max="1" checkflags="isconfigurable" />
      </action>

      <action name="editreg" onexecute="doeditreg" tid="sysmgmt.registry.title" />
      <action name="adhoccache" onexecute="doadhoccache" tid="sysmgmt.adhoccache.title" />
      <action name="remoting" onexecute="doremoting" tid="sysmgmt.remoting.title" />
      <action name="backend" onexecute="dobackend" tid="tolliumapps.config.settings.settings" shortcut="ctrl+shift+t" />
      <action name="webdavdata" onexecute="dowebdavdata" tid="sysmgmt.webdav.data.title" />
      <action name="scheduler" onexecute="doscheduler" tid="sysmgmt.scheduler.title" />
      <action name="mailroutes" onexecute="domailroutes" tid="tolliumapps.config.mailrouting.mailroutes" shortcut="ctrl+shift+e" />
      <action name="apprunner" onexecute="doapprunner" tid="sysmgmt.apprunner.title" />

      <action name="connectremote" onexecute="doconnectremote" shortcut="ctrl+p" frameflags="developer"/>
      <windowopenaction name="openwebsite" onwindowopen="onopenwebsite">
        <enableon source="modules" min="1" max="1" checkflags="havewebsite" />
      </windowopenaction>

      <action name="close" onexecute="DoClose" tid="~exit"/>
    </actions>
    <menus>
      <menu name="menubar">
        <item action="uploadmodule"/>
        <item action="openwebsite" />
        <divider />
        <item action="backend"  />
        <item action="editreg"  />
        <item action="adhoccache"  />
        <item action="remoting"  />
        <item action="apprunner"  />
        <item action="scheduler"  />
        <item action="webdavdata"  />
        <item action="mailroutes"  />
        <divider/>
        <item action="versions" />
        <item action="configuremodule" />
        <divider/>
        <item action="refresh"/>
        <item action="close" />

      </menu>
      <menu name="noselection_modules">
        <item action="uploadmodule"/>
      </menu>
      <menu name="selection_modules">
        <item action="openwebsite" />
        <divider />
        <item action="versions" />
        <item action="configuremodule" />
        <divider />
        <item action="deletemodule" />
      </menu>
    </menus>

    <compositions>
      <eventlistener name="giteventlistener" masks="system:modulefolder.mod::*/.git/*" onevents="GotGitEvent" groupinterval="1000" />
      <eventlistener name="moduleeventlistener" masks="system:softreset system:moduleupdate" onevents="GotModuleEvent" groupinterval="1000" />
    </compositions>

    <toolbar>
      <button action="configuremodule" icon="tollium:objects/cog" />
      <divider/>
      <button action="uploadmodule" icon="tollium:actions/upload"/>
      <button action="versions" icon="tollium:actions/history"/>
      <divider />
      <button action="mailroutes" icon="tollium:system/emailrouting"/>
      <divider />
      <button action="connectremote"    icon="tollium:objects/rackserver" name="connectremotebutton" tid=".connectremote" />
    </toolbar>
    <body height="1pr" spacers="none">
      <panel  backgroundcolor="#f0f0f0" spacers="left right">
        <line layout="tabs-space">

          <select rowkeytype="boolean" name="showdeleted" title="" type="pulldown" onchange="onshowdeletedchange">
            <option rowkey="false" tid=".dontshowdeleted"/>
            <option rowkey="true" tid=".showdeleted"/>
          </select>
          <spacer />
          <text name="localheading" title="" value="" />
        </line>
      </panel>


      <panel height="1pr">
        <list name="modules"
              selectmode="single"
              height="1pr"
              icons="tollium:files/text_plain tollium:objects/webhare tollium:tollium/tollium tollium:status/versioned tollium:objects/cog "
              selectcontextmenu="selection_modules"
              newcontextmenu="noselection_modules"
              openaction="configuremodule"
              sortcolumn="name"
              borders="top bottom"
              flags="canmanage canseeversions isavailable isconfigurable havewebsite"
              ongetrows="getmodules">
          <column name="name"         type="text"     width="1pr" iconname="typeicon" />
          <column name="configicon"   type="icon"     width="16px" title="" />
          <column name="version"      type="text"     width="16x" align="right" />
          <column name="revision"     type="text"     width="1pr" />
          <column name="description"  type="text"     width="3pr" tid="~description"/>
          <column name="lastmodified" type="datetime" precision="minutes" width="16x" storeutc="true" />
          <style name="deleted" textcolor="#AAAAAA" />
        </list>
      </panel>
    </body>
  </screen>
</screens>
