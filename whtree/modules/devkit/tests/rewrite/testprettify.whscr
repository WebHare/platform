<?wh

LOADLIB "mod::system/lib/testframework.whlib";
LOADLIB "mod::system/lib/internal/modules/json.whlib";


MACRO TestJSONFormatAPI()
{
  //inspired by jq's output
  TestEq(`"hi"`, PrettifyJSON(`'hi'`));
  TestEq(`42`, PrettifyJSON(`42`));
  TestEq(`true`, PrettifyJSON(`true`));
  TestEq(`null`, PrettifyJSON(`null`));
  TestEq(`[]`, PrettifyJSON(`[]`));
  TestEq(`[\n  1\n]`, PrettifyJSON(`[1]`));
  TestEq(`[\n  1,\n  2\n]`, PrettifyJSON(`[1,2]`));
  TestEq(`{
  "body": 42
}`, PrettifyJSON(`{"body":42}`));

  TestEq(`{
  "body": 42,
  "header": 15
}`, PrettifyJSON(`{"body":42,"header":15}`));

  TestEq(`[
  {
    "body": 42
  },
  {
    "header": 15
  }
]`, PrettifyJSON(`[{"body":42},{"header":15}]`));


  TestEQ(`{
  "body": {
    "MUST": [
      {
        "constant_score": 42
      },
      {
        "constant_score": 43
      }
    ]
  }
}`, PrettifyJSON(`{'body': {'MUST': [{ "constant_score": 42      },{ 'constant_score': 43      }    ]}}`));
}


RunTestFramework([ PTR TestJSONFormatAPI ]);
