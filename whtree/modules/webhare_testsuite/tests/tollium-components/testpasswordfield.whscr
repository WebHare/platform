<?wh
LOADLIB "mod::system/lib/testframework.whlib";
LOADLIB "mod::tollium/lib/testframework.whlib";

MACRO TestPasswordSyntax()
{
  OBJECT screen := GetTestController()->LoadScreen(`inline::
<screens xmlns="http://www.webhare.net/xmlns/tollium/screens">
  <screen name="test" implementation="none">
    <body>
      <passwordfield name="passwordfield" />
    </body>
  </screen>
</screens>#test`);

  TestEq("", screen->passwordfield->value);
}

OBJECT ASYNC FUNCTION TestPasswordField()
{
  OBJECT browser := GetTestController()->LoadScreen("webhare_testsuite:tests/anycomponent.anycomponent",
                                                   [ component := "passwordfield"
                                                   , settings := [ required := true
                                                                 , entercurrentpassword := false
                                                                 ]
                                                   ]);

  AWAIT ExpectScreenChange(+1, PTR browser->RunModal());

  TestEq("",topscreen->comp->value);

  AWAIT ExpectScreenChange(-1, PTR topscreen->TolliumExecuteCancel());

  RETURN TRUE;
}

RunTestframework([ PTR TestPasswordSyntax
                 , PTR TestPasswordField
                 ]);
