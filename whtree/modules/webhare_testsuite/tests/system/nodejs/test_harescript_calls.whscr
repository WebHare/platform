<?wh
LOADLIB "wh::internal/testfuncs.whlib";
LOADLIB "wh::javascript.whlib";

OBJECT std := ImportJs("@webhare/std");
TestEqLike("????????-????-????-????-????????????", std->GenerateRandomId("uuidv4"));

OBJECT imp := ImportJs(Resolve("data/calls.ts"));
TestEq(imp, ImportJs(Resolve("data/calls.ts")), "should simply be the same object so callers don't have to bother centrally keeping refs");

OBJECT promise42 := imp->test42();
TestEq(42, WaitForPromise(promise42), "Expect async functions to be automatically awaited (until we can return promises?)");

STRING randomonce := imp->getOnceRandom();
STRING randomtwice := imp->getOnceRandom();
TestEq(randomonce, randomtwice, "Should be equal as we expect ImportJS to cache loaded lib instances");
