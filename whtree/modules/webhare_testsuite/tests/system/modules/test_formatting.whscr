<?wh

LOADLIB "wh::files.whlib";

LOADLIB "mod::system/lib/testframework.whlib";
LOADLIB "mod::system/lib/internal/validation/javascript.whlib";


ASYNC MACRO TestTypeScriptFormatting()
{
  /* We need to reference an existing file, otherwise the typescript-eslint parsing
     services will give an error it is not included in the tsconfig project.
  */
  TestEQ(
"export const x = function (arg: number) { };\n" ||
"\n" ||
"function test(): void {\n" ||
"  /*\n" ||
"  uitgecomment\n" ||
"\n" ||
"  allemaal\n" ||
"  */\n" ||
"}\n", BlobToString((AWAIT FormatJavascriptFile("mod::webhare_testsuite/js/testhelpers.ts", StringToBlob(
`export const x = function(arg: number) { };

function test(): void {
/*
uitgecomment

allemaal
*/
}`), [ autofix := TRUE ])).output));
}

RunTestframework([ PTR TestTypeScriptFormatting
                 ], [ usedatabase := FALSE
                    ]);
