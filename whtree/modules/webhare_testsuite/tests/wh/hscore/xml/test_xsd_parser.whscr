<?wh

LOADLIB "wh::xml/dom.whlib";
LOADLIB "wh::xml/validation.whlib";

LOADLIB "mod::system/lib/resources.whlib";
LOADLIB "mod::system/lib/testframework.whlib";
LOADLIB "mod::system/lib/internal/resources.whlib";

MACRO TestParse()
{
  STRING resourcename := Resolve("testdata/testfile.xsd");
  OBJECT doc := MakeXMLDocument(GetWebhareResource(resourcename));
  OBJECT domimpl := GetWebhareXMLDOMImplementation();
  OBJECT parser := CreateXSD2001Parser(domimpl);
  ParseXSDSchema(parser, doc->documentelement, resourcename);
  TestEqMembers([[ namespaceuri := 'http://www.webhare.net/xmlns/webhare_testsuite/testfile', name := 'myelement' ]], parser->elements, "*");
  TestEqMembers([[ namespaceuri := 'http://www.webhare.net/xmlns/webhare_testsuite/testfile', name := 'myattr' ]], parser->attributes, "*");
}

Runtestframework([ PTR TestParse ]);
