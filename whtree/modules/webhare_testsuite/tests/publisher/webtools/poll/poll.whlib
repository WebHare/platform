<?wh
LOADLIB "mod::publisher/lib/publisher.whlib";
LOADLIB "mod::publisher/lib/webtools/poll.whlib";
LOADLIB "mod::system/lib/database.whlib";
LOADLIB "mod::webhare_testsuite/lib/system/tests.whlib";

PUBLIC RECORD FUNCTION TESTINVOKE_RESETTESTPOLL()
{
  OBJECT trans := OpenPrimary();
  trans->BeginWork();

  OBJECT testsite := OpenTestsuiteSite();
  OBJECT pollfile := testsite->OpenByPath("webtools/polltest");
  OpenPoll(pollfile->id)->ResetVotes();
  OBJECT pollfile2 := testsite->OpenByPath("webtools/polltest2");
  OpenPoll(pollfile2->id)->ResetVotes();
  OBJECT pollholder := testsite->OpenByPath("webtools/pollholder");

  trans->CommitWork();

  RETURN [ pollurl := GetPreviewLink(pollfile->id)
         , pollholder := pollholder->link
         ];

}
