<?wh

LOADLIB "mod::system/lib/database.whlib";

PUBLIC MACRO FileEntry()
{
  OBJECT trans := GetPrimaryWebhareTransactionObject();
  IF (NOT ObjectExists(trans)) ABORT("No transaction");
  IF (NOT trans->HasWorkSupport()) ABORT("No auto-transaction");
  PRINT("dynfile:" || GetStoredScriptProperty("FILEID") || "\n" ||
      AnyToString(-1 IN trans->GetEnabledRoles() ? [-1] : SortArray(trans->GetEnabledRoles()), "tree"));
}

PUBLIC MACRO FileOverrideEntry()
{
  OBJECT trans := GetPrimaryWebhareTransactionObject();
  IF (NOT ObjectExists(trans)) ABORT("No transaction");
  IF (NOT trans->HasWorkSupport()) ABORT("No auto-transaction");
  PRINT("dynoverride:" || GetStoredScriptProperty("FILEID") || "\n" ||
      AnyToString(-1 IN trans->GetEnabledRoles() ? [-1] : SortArray(trans->GetEnabledRoles()), "tree"));
}

PUBLIC MACRO FolderEntry()
{
  OBJECT trans := GetPrimaryWebhareTransactionObject();
  IF (NOT ObjectExists(trans)) ABORT("No transaction");
  IF (NOT trans->HasWorkSupport()) ABORT("No auto-transaction");
  PRINT("dynfolder:" || GetStoredScriptProperty("FILEID") || "\n" ||
      AnyToString(-1 IN trans->GetEnabledRoles() ? [-1] : SortArray(trans->GetEnabledRoles()), "tree"));
}
