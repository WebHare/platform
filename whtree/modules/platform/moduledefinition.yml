managedServices:
  apprunner:
    script: mod::system/scripts/internal/apprunner.whscr
    run: always
  tollium-wasm-runner:
    script: mod::tollium/scripts/internal/applicationstarter.whscr
    run: on-demand
    engine: wasm
  nodeservices: # Implements JS-based <backendservice>s
    script: js/nodeservices/nodeservices.ts
    run: always
  unifiedcache: # Temporarily split off due to memory usage
    script: js/nodeservices/imgcache.ts
    run: always
    # When stress-testing/debugging, lower restartInterval to 1sec in imgcache.ts and enable these below:
    # minRunTime: 1
    # maxThrottleMsecs: 5


backendServices:
  openapiservice:
    clientFactory: "mod::system/js/internal/openapi/openapiservice.ts#getServiceInstance"
  jsrouterservice:
    clientFactory: "mod::system/js/internal/webserver/jsrouterservice.ts#getJSRouter"
  fetchpool:
    clientFactory: "mod::system/js/internal/fetchpool/fetchpool.ts#getFetcher"
  jsonapicaller:
    clientFactory: "mod::system/js/internal/jsonrpccaller.ts#getJSONApiCaller"
  configuration:
    controllerFactory: js/configure/configservice.ts#createConfigManager
    coreService: true

selfChecks:
  - checker: js/checks/servicechecks.ts#checkMissingServices

assetPacks:
  pwaserviceworker:
    entryPoint: webfeatures/pwaserviceworker/pwaserviceworker
    supportedLanguages: [en]
    whPolyfills: false

webFeatures:
  identityprovider:
    siteProfile: webfeatures/identityprovider/identityprovider.siteprl.xml
