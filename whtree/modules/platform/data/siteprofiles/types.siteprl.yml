gid: siteprofiles.types
types:
  ######## File types
  filetypes.abtest:
    namespace: http://www.webhare.net/xmlns/publisher/abtest/abtestfile
    gid: publisher:siteprofile.abtest
    tid: publisher:siteprofile.abtest.filetype
    metaType: page
    workflow: false
    members:
      abgroup:
        type: string
      durationDays:
        type: integer
      aboptions:
        type: array
        members:
          aboption:
            type: string
          weight:
            type: integer
          target:
            type: whfsRef
    apply:
      editProps:
        - type: publisher:abtest.abtestfile
          tabsExtension: mod::publisher/data/siteprofiles/abtest.siteprl.xml#abtest
      usePublishTemplate: mod::publisher/lib/internal/webdesign/abtest-publish.whscr
  filetypes.archive:
    namespace: http://www.webhare.net/xmlns/publisher/archivefile
    icon: tollium:files/application_zip #The archive file type uses the 'application/zip' icon as we don't have a general 'archive' icon
    metaType: upload
    requiresContent: true
  filetypes.contentlink:
    namespace: http://www.webhare.net/xmlns/publisher/contentlink
    icon: tollium:files/application_x-webhare-contentlink
    metaType: page
    workflow: false
    isAcceptableIndex: false
    isPublishedAsSubdir: false
  filetypes.contentlisting:
    namespace: http://www.webhare.net/xmlns/publisher/contentlisting
    icon: tollium:files/application_x-webhare-contentlisting
    metaType: page
    workflow: false
    isPublishedAsSubdir: true
  filetypes.css:
    namespace: http://www.webhare.net/xmlns/publisher/cssfile
    icon: tollium:files/text_css
    metaType: upload
    extension: .css
    searchContentProvider: publisher:contentblob
  filetypes.dynamicfoldercontents:
    namespace: http://www.webhare.net/xmlns/publisher/dynamicfoldercontents
    icon: tollium:files/application_x-webhare-contentlisting
    metaType: page
    workflow: false
    useWebDesign: false
    isPublishedAsSubdir: false
  filetypes.externallink:
    namespace: http://www.webhare.net/xmlns/publisher/externallink
    icon: tollium:files/application_x-webhare-externallink
    metaType: page
    workflow: false
    useWebDesign: false
    apply:
      usePublishTemplate: mod::publisher/scripts/internal/publishlink.whscr
  filetypes.form:
    namespace: http://www.webhare.net/xmlns/publisher/formwebtool
    icon: tollium:files/application_x-webhare-survey
    metaType: page
    workflow: true
    dynamicExecution:
      webPageObjectName: mod::publisher/lib/forms/base.whlib#WebtoolFormPage
    searchContentProvider: publisher:webtoolform
    members:
      disablecaptcha:
        title: Disable captcha verification
        type: boolean
      storeresults:
        title: How long to store form results (in days)
        type: integer
        comment: Because the default value is 0 and the default should be "use the server default retention period", the value -1 (or any value < 0) is used to signify 0 days (don't store at all)
      maxsignups:
        title: Maximum number of signups allowed
        type: integer
      data:
        title: Form contents
        type: composedDocument
      unavailable:
        title: The form is unavailable
        type: boolean
      unavailabletext:
        title: Text to show when the form is unavailable
        type: richTextDocument
    deleteMembers:
      - fixformoptions #archived original remapping in case we ever needed it. Deleted in WH6.0
    apply:
      setObjectEditor:
        separateApp: true
        name: publisher:webtoolform

  filetypes.html:
    namespace: http://www.webhare.net/xmlns/publisher/htmlfile
    icon: tollium:files/text_html
    metaType: upload
    extension: .html
    isAcceptableIndex: true
    useWebDesign: true
    searchContentProvider: publisher:contentblob
    apply:
      bodyRenderer:
        objectName: mod::publisher/lib/internal/renderers/htmlfile.whlib#StaticHTMLFile
      setObjectEditor:
        name: publisher:texteditor
  filetypes.image:
    namespace: http://www.webhare.net/xmlns/publisher/imagefile
    icon: tollium:files/image
    metaType: upload
    requiresContent: true
    browserPreview: /.wh/common/preview/image.shtml
  filetypes.internallink:
    namespace: http://www.webhare.net/xmlns/publisher/internallink
    icon: tollium:files/application_x-webhare-internallink
    metaType: page
    workflow: false
    useWebDesign: false
    apply:
      usePublishTemplate: mod::publisher/scripts/internal/publishlink.whscr
  filetypes.javascript:
    namespace: http://www.webhare.net/xmlns/publisher/javascriptfile
    icon: tollium:files/application_x-javascript
    metaType: upload
    extension: .js
    searchContentProvider: publisher:contentblob
  filetypes.library:
    namespace: http://www.webhare.net/xmlns/publisher/libraryfile
    icon: tollium:files/application_x-webhare-library
    metaType: upload
    extension: .whlib
    isPublishable: false
    searchContentProvider: publisher:contentblob
  filetypes.markdown:
    namespace: http://www.webhare.net/xmlns/publisher/markdownfile
    icon: tollium:files/text_plain
    metaType: page
    workflow: true
    searchContentProvider: publisher:markdown
    members:
      data:
        type: composedDocument
    apply:
      bodyRenderer:
        contentBuilder: mod::publisher/js/internal/markdown.ts#renderMarkdown
      setObjectEditor:
        separateApp: true
        name: publisher:editmarkdown
  filetypes.mp3audio:
    namespace: http://www.webhare.net/xmlns/publisher/mp3audiofile
    icon: tollium:files/audio
    metaType: upload
    requiresContent: true
  filetypes.msworddownload:
    namespace: http://www.webhare.net/xmlns/publisher/msworddownload
    icon: tollium:files/application_msword
    metaType: upload
    requiresContent: true
    extension: .doc
    searchContentProvider: publisher:contentblob
  filetypes.multimedia:
    namespace: http://www.webhare.net/xmlns/publisher/multimediafile
    comment: The multimedia file type uses the 'video' icon as we don't have a
      general 'multimedia' icon
    icon: tollium:files/video
    metaType: upload
    requiresContent: true
  filetypes.pdf:
    namespace: http://www.webhare.net/xmlns/publisher/pdffile
    icon: tollium:files/application_pdf
    metaType: upload
    requiresContent: true
    extension: .pdf
    browserPreview: /.wh/common/preview/direct.shtml
    searchContentProvider: publisher:contentblob
  filetypes.plaintext:
    namespace: http://www.webhare.net/xmlns/publisher/plaintextfile
    icon: tollium:files/text_plain
    metaType: upload
    extension: .txt
    searchContentProvider: publisher:contentblob
  filetypes.profile:
    namespace: http://www.webhare.net/xmlns/publisher/profilefile
    icon: tollium:files/application_x-webhare-profile
    metaType: upload
    extension: .prl
    isPublishable: false
    searchContentProvider: publisher:contentblob
  filetypes.richdocument:
    namespace: http://www.webhare.net/xmlns/publisher/richdocumentfile
    icon: tollium:files/application_x-webhare-richdocument
    metaType: page
    workflow: true
    searchContentProvider: publisher:rtd
    members:
      data:
        type: richTextDocument
    deleteMembers:
      - original # Stored original Word documents. Deleted in WH6.0
    apply:
      bodyRenderer:
        objectName: mod::publisher/lib/internal/renderers/rtd.whlib#RenderRTD
      setObjectEditor:
        name: publisher:editdocument
  filetypes.search:
    comment: Consilio search page
    namespace: http://www.webhare.net/xmlns/consilio/searchpage
    tid: consilio:webfeatures.sitecontent.searchpage.searchpage
    metaType: page
    workflow: false
    dynamicExecution:
      webPageObjectName: mod::consilio/webfeatures/sitecontent/searchpage/searchpage.whlib#ConsilioSearchPage
  filetypes.semidynamic:
    namespace: http://www.webhare.net/xmlns/publisher/semidynamicfile
    icon: tollium:files/application_x-webhare-semidynamic
    metaType: upload
    extension: .html
    isAcceptableIndex: true
    useWebDesign: true
  filetypes.sitemap:
    icon: tollium:files/text_xml
    metaType: page
    isPublishedAsSubdir: false
    workflow: false
    isAcceptableIndex: false # should have XML extension and cannot be renamed to index.html
    apply:
      usePublishTemplate: mod::publisher/scripts/internal/publishsitemap.whscr
  filetypes.shtml:
    namespace: http://www.webhare.net/xmlns/publisher/shtmlfile
    icon: tollium:files/application_x-webhare-whscript
    metaType: upload
    extension: .shtml
    isAcceptableIndex: true
    searchContentProvider: publisher:contentblob
  filetypes.shtmlwithdesign:
    namespace: http://www.webhare.net/xmlns/publisher/shtmlwithdesignfile
    icon: tollium:files/application_x-webhare-whscript
    metaType: upload
    extension: .shtml
    isAcceptableIndex: true
    useWebDesign: true
    searchContentProvider: publisher:contentblob
  filetypes.tag:
    namespace: http://www.webhare.net/xmlns/publisher/tagfile
    icon: tollium:files/application_x-webhare-tag
    metaType: dataFile
    members:
      belongstorepos:
        type: whfsRefArray
  filetypes.tagrepository:
    namespace: http://www.webhare.net/xmlns/publisher/tagrepository
    icon: tollium:folders/repository
    metaType: dataFile
    members:
      tags:
        type: whfsRefArray
  filetypes.targz:
    namespace: http://www.webhare.net/xmlns/publisher/targzfile
    icon: tollium:files/application_x-gzip
    metaType: upload
    requiresContent: true
    extension: .tar.gz
  filetypes.template:
    namespace: http://www.webhare.net/xmlns/publisher/templatefile
    icon: tollium:files/application_x-webhare-template
    metaType: upload
    extension: .tpl
    isPublishable: false
    searchContentProvider: publisher:contentblob
  filetypes.unknown:
    namespace: http://www.webhare.net/xmlns/publisher/unknownfile
    icon: tollium:files/application_x-webhare-unknown
    metaType: upload
    requiresContent: true
  filetypes.webharearchive:
    namespace: http://www.webhare.net/xmlns/publisher/webharearchivefile
    icon: tollium:files/application_wharchive
    metaType: upload
    requiresContent: true
    extension: .wharchive
    isPublishable: false
  filetypes.witty:
    namespace: http://www.webhare.net/xmlns/publisher/wittyfile
    icon: tollium:files/application_x-webhare-witty
    metaType: upload
    extension: .witty
    isPublishable: false
    searchContentProvider: publisher:contentblob
  filetypes.xml:
    namespace: http://www.webhare.net/xmlns/publisher/xmlfile
    icon: tollium:files/text_xml
    metaType: upload
    extension: .xml
    searchContentProvider: publisher:contentblob
  filetypes.zip:
    namespace: http://www.webhare.net/xmlns/publisher/zipfile
    icon: tollium:files/application_zip
    metaType: upload
    requiresContent: true
    extension: .zip

  ######## Folder types
  foldertypes.default:
    namespace: http://www.webhare.net/xmlns/publisher/normalfolder
    comment: Define the special '0' types
    icon: tollium:folders/normal
    metaType: folder
  foldertypes.extern:
    namespace: http://www.webhare.net/xmlns/publisher/foreignfolder
    icon: tollium:folders/locked
    metaType: folder
  foldertypes.photoalbum:
    comment: "Photo albums have been deprecated. Minimal support for the folder type remains"
    namespace: http://www.webhare.net/xmlns/publisher/photoalbum
    icon: tollium:folders/photoalbum
    metaType: folder
    apply:
      folderIndex:
        newFileType: filetypes.contentlisting
        pin: true
  foldertypes.system:
    namespace: http://www.webhare.net/xmlns/publisher/systemfolder
    icon: tollium:folders/system
    metaType: folder
  foldertypes.tags:
    namespace: http://www.webhare.net/xmlns/publisher/tagfolder
    icon: tollium:folders/tag
    metaType: folder

  web.sitesettings:
    namespace: http://www.webhare.net/xmlns/publisher/sitesettings
    workflow: false
    members:
      sitedesign:
        type: string
      webfeatures:
        type: stringArray
      comments:
        type: string
        tid: ~comments
      productionurl:
        type: string

  ## SEO and other extended metadata used when publishing to the web
  web.metadata:
    workflow: true
    clone: onCopy
    comment: Extended metadata for web publishing. eg. seotitle, schema.org, ..
    # TODO we still need to design and add schema.org support but it would appear here. likewise og:data things could appear here
    members:
      seoTitle:
        type: string
        comment: Override the <title> tag to use in the HTML head

  web.config:
    workflow: false
    clone: onArchive
    comment: Web configuration for a file or folder. Managed outside workflow
    members:
      comments:
        type: string
        comment: Comments for editors/administrators to explain the SEO choices, not shown on the site
      noIndex:
        type: boolean
        comment: Set 'noindex', preventing search engines from indexing this page or folder, recursively
      noFollow:
        type: boolean
        comment: Set 'nofollow', preventing search engines from following links on this page or folder, recursively
      noArchive:
        type: boolean
        comment: Set 'noarchive', preventing search engines from storing a cached copy of this page or folder
      customRobots:
        type: string
        comment: Custom robots meta tag content
      canonical:
        type: whfsRef
        comment: Points to the canonical URL of this page. No defined effect yet on folders

deleteTypes:
  - http://www.webhare.net/xmlns/publisher/version # redundant with fs_history table. Deleted in WH6.0

apply:
  - to: all
    priority: -100
    comment: Global Publisher configuration
    debugSettings: # Debug settings available everywhere
      - groupTitle: Commonly used
        flags:
          apr:
            title: Auto-profile dynamic pagines
            requireRight: ""
          etr:
            title: Show error stacktraces
      - groupTitle: Tollium debugging
        flags:
          ild:
            title: "Image loading: debug SVG composition"
          isc:
            title: "Image editor: Debug smartcrop"
      - groupTitle: Site testing
        flags:
          anl:
            title: Social & analytics
          bac:
            title: Beacons/Adapative Content
          ner:
            title: No errorhandler.js
          npm:
            title: Don't set previewmode when previewing
          nsc:
            title: No spam checks (disable recaptchas etc)
          pxl:
            title: Pxl events
            requireRight: ""
          sne:
            title: Don't embed external scripts like GTM
          win:
            title: Witty invocations
      - groupTitle: RPCs & authentication
        flags:
          aut:
            title: wrd.auth
          rpc:
            title: RPC request and responses
      - groupTitle: Formsapi
        flags:
          fdv:
            title: Disable client-side validation
          fhv:
            title: Validation
          fnh:
            title: Never hide
      - groupTitle: Designfiles components
        flags:
          men:
            title: wh.menu debugging
          meo:
            title: wh.menu/pulldown keep open
          rte:
            title: wh.rich debugging
          upl:
            title: wh.net.upload debugging
      - groupTitle: Miscellaneous
        flags:
          bus:
            title: Busy & waits
          gtd:
            title: Debug getTid
          key:
            title: Dompack Keyboard
          pro:
            title: Trace promises for unhandled rejections
          sho:
            title: Webshop
          sut:
            title: Short unknown tids
          testfw:
            title: Testframework
          wud:
            title: Webserver url debugging
  - to: all
    intercept:
      checkabtestpublish:
        interceptFunction: mod::publisher/lib/internal/webdesign/abtest.whlib#checkabtestpublishHook
        target: publisher:documenteditor
