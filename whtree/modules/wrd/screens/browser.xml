<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
  xmlns:wrd="http://www.webhare.net/xmlns/wrd/components"
  xmlns:portal="http://www.webhare.net/xmlns/tollium/portal/components"
  lib="screens/browser.whlib"
  gid="browser"
  >

  <messageboxes gid=".messages">
    <messagebox name="deletetype"               icon="question" buttons="yes no" />
    <messagebox name="cannotdeletetype"         icon="information" buttons="ok" />
    <messagebox name="deleteperson"             icon="question" buttons="yes no" />
    <messagebox name="deletepersons"            icon="question" buttons="yes no" />
    <messagebox name="deleteorg"                icon="question" buttons="yes no" />
    <messagebox name="deleteorgs"               icon="question" buttons="yes no" />
    <messagebox name="deleteentities"           icon="question" buttons="yes no" />
    <messagebox name="deleteentity"             icon="question" buttons="yes no" />
    <messagebox name="deletelinks"              icon="question" buttons="yes no" />
    <messagebox name="confirmmergeentity"       icon="question" buttons="yes no" />
  </messageboxes>

  <screen name="main"
          allowresize="true"
          flags="can_back can_forward can_edit_entity can_search_free right_metadata right_readwrite has_accounts has_usermgmt has_saml"
          menubar="menubar"
          gid=".main"
          tid=".title"
          icon="tollium:database/database">
    <actions gid=".actions">
      <action name="editentity" onexecute="doeditentity" ellipsis="true">
        <enableon source="results_frees"   min="1" max="1" checkflags="can_edit_entity" requirefocus="true" />
      </action>
      <action name="mergeentity" onexecute="domergeentity" ellipsis="true">
        <enableon source="results_frees"   min="1" max="1" checkflags="can_edit_entity" requirefocus="true" />
      </action>

      <action name="deleteentity" onexecute="dodeleteentity">
        <!-- FIXME: Support multiple -->
        <enableon source="results_frees"   min="1" checkflags="can_edit_entity" requirefocus="true" />
      </action>
      <action name="exitapplication" onexecute="doexitapplication" />

      <action name="managetypes" frameflags="right_metadata" onexecute="domanagetypes" />
      <action name="manageschemas" onexecute="domanageschemas" shortcut="ctrl+o" />
      <action name="managependingpayments" onexecute="domanagependingpayments" frameflags="right_readwrite" />
      <action name="managepaymentproviders" onexecute="domanagepaymentproviders" />
      <action name="exportschema" onexecute="doexportschema"  />
      <action name="exportxmlmetadata" onexecute="doexportxmlmetadata"  />
      <action name="exportdotstructure" onexecute="doexportdotstructure"  />
      <action name="addtostartmenu" tid="tollium:common.actions.addtostartmenu" onexecute="doaddtostartmenu" />

      <action name="newfree" frameflags="right_readwrite" onexecute="donewfree" />
      <action name="schemaprops" onexecute="doschemaprops" frameflags="right_metadata" />
      <action name="authsettings" onexecute="doauthsettings" frameflags="right_metadata" />
      <action name="auditlog"  onexecute="doauditlog" frameflags="has_accounts" />
      <action name="samlauth"  onexecute="dosamlauth" frameflags="right_metadata has_saml" />

      <action name="openlink" onexecute="doopenlink">
        <enableon source="links" min="1" max="1" />
      </action>
      <action name="editlink" onexecute="doeditlink" frameflags="right_readwrite">
        <enableon source="links" min="1" max="1" />
      </action>
      <action name="followlink" onexecute="dofollowlink">
        <enableon source="links" min="1" max="1" checkflags="canfollow" />
      </action>
      <action name="addlink" frameflags="right_readwrite" onexecute="doaddlink">
        <enableon source="results_frees"     min="1" max="1" checkflags="can_add_link" />
      </action>
      <action name="deletelink" frameflags="right_readwrite" onexecute="dodeletelink">
        <enableon source="links" min="1" />
      </action>

      <action name="showhistory">
        <enableon source="results_frees" min="1" max="1" onexecute="doshowhistory_results" />
      </action>

      <action name="gotoid" onexecute="dogotoid" />

      <action name="togglelinks" onexecute="dotogglelinks" />
      <action name="toggledataviewer" onexecute="dotoggledataviewer" />

      <action name="querybuilder" onexecute="doquerybuilder" />
      <action name="anonymize"  onexecute="doanonymize" frameflags="right_metadata" />
    </actions>

    <menus gid=".menu">
      <menu name="menubar">
        <item tid="tollium:common.actions.export">
          <item action="exportschema" />
          <item action="exportxmlmetadata" />
          <item action="exportdotstructure" />
        </item>
        <divider/>
        <item action="editentity" />
        <item action="mergeentity" />
        <item action="deleteentity" />
        <divider />
        <item tid=".schema">
          <item action="schemaprops" />
          <item action="authsettings" />
          <item action="anonymize" />
          <item action="auditlog" />
          <item action="samlauth" />
          <divider />
          <item action="managetypes" />
          <item action="managepaymentproviders"/>
        </item>
        <item action="addtostartmenu" />
        <divider />
        <item action="manageschemas" />
        <item action="querybuilder" />
        <divider />
        <item action="exitapplication" />
      </menu>

      <menu name="selection_links">
        <item action="openlink" />
        <item action="editlink" />
        <item action="deletelink" />
        <item action="followlink" />
      </menu>

      <menu name="noselection_links">
        <item action="addlink" />
      </menu>

      <menu name="resultscontextmenu">
        <item action="editentity" />
        <item action="deleteentity" />
        <item action="showhistory" />
        <divider />
        <item action="addlink" />
      </menu>
    </menus>

    <toolbar name="buttons">
      <button action="newfree" icon="tollium:actions/add" tid="tollium:common.actions.add"  />
      <button action="editentity" icon="tollium:actions/edit" />
      <button action="deleteentity" icon="tollium:actions/delete" />
      <divider />
      <button action="managetypes" icon="tollium:database/types" />
      <button action="manageschemas" icon="tollium:database/schema"/>
      <divider />
      <button action="querybuilder" icon="tollium:database/sql_client"/>
      <divider/>
      <button action="togglelinks" icon="tollium:actions/link" name="togglelinksbtn" tid="browser.main.actions.togglelinks"/>
      <button action="toggledataviewer" icon="tollium:actions/view" name="toggledataviewerbtn" tid="browser.main.actions.toggledataviewer" />
    </toolbar>

    <body spacers="none">
      <tabs type="server" name="maintabs" height="1pr">
        <tab name="emptytab" title="">
          <panel height="1pr" />
        </tab>

        <tab name="browsertab" title="" spacers="none">
          <split type="horizontal">
            <part width="7pr">
              <panel name="freesearchbox" backgroundcolor="#f0f0f0" spacers="left right">
                <line>
                  <select name="freetype" type="pulldown" onchange="onselectfreetype" />
                  <wrd:quickfilter name="quickfilter" onsearch="onquickfiltersearch"/>
                </line>
              </panel>
              <!--box tid=".searchresults" height="1pr"-->
                <panel height="1pr">
                  <list name="results_frees"
                        selectmode="multiple"
                        onselect="onselectentity"
                        flags="can_edit_entity can_add_link"
                        openaction="editentity"
                        selectcontextmenu="resultscontextmenu"
                        onfocusin="onmainlistfocus"
                        >
                      <style name="notavailable" textcolor="#9a9a9a" />
                  </list>
                </panel>
                <text name="resultcount"/>
              <!--/box-->

              <box tid=".currententity"  >
                <grid width="1pr" ><col width="1pr"/><col width="1pr"/>
                  <row>
                    <cell layout="left" width="1pr"><text name="entitypath" selectable="true" /></cell>
                    <cell layout="left" width="1pr"><text name="entityid" selectable="true" /></cell>
                  </row>
                </grid>
                <text name="linkcount" visible="false" action="togglelinks"/>
              </box>

              <box tid=".links" height="1pr" name="linksbox" visible="false" >
                <panel spacers="right bottom" height="1pr">
                  <grid height="1pr" >
                    <col width="1pr" />
                    <col />
                    <row height="1pr" >
                      <cell height="1pr">
                        <list name="links"
                              selectmode="multiple"
                              onselect="onselectentitylink"
                              flags="canfollow"
                              selectcontextmenu="selection_links"
                              newcontextmenu="noselection_links"
                              openaction="openlink"
                              onfocusin="onlinksfocus">
                          <column name="creationdate" type="datetime" width="16x" storeutc="true" /><!-- for easy finding of recently added links (for example a game played by a wrd_person) -->
                          <column name="type" type="text" width="1pr" />
                          <column name="col1" type="text" width="1pr" title="" />
                          <column name="col2" type="text" width="1pr" title="" />
                          <column name="col3" type="text" width="1pr" title="" />

                          <style name="notavailable" textcolor="#9a9a9a" />
                          <!-- FIXME: Doesn't seem to do much
                          <column name="description" type="text" width="3pr" />
                          -->
                        </list>
                      </cell>
                      <cell>
                        <button action="editlink" width="1pr" />
                        <button action="deletelink" width="1pr" />
                        <button action="openlink" width="1pr"/>

                        <panel>
                          <button action="addlink" width="1pr"/>
                          <button action="followlink" width="1pr"/>
                        </panel>
                      </cell>
                    </row>
                  </grid>
                </panel>
              </box>
            </part>
            <part name="dataviewer" width="3pr" visible="false">
              <hsvalue name="entitycontent" />
            </part>
          </split>
        </tab>

      </tabs>
    </body>
  </screen>

  <screen name="gotoid" gid="gotoid">
    <body>
      <textedit name="entityid" />
    </body>
    <footer>
      <defaultformbuttons buttons="ok cancel" />
    </footer>
  </screen>

  <screen name="chooselinktype" gid="chooselinktype">
    <body name="linktypepage">
      <box name="linkselection">
        <select name="linktypes" type="radio" rowkeytype="integer" required="true" />
      </box>
    </body>
    <footer>
      <defaultformbuttons buttons="ok cancel" />
    </footer>

  </screen>


</screens>
