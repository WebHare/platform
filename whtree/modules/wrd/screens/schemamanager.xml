<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         xmlns:wrd="http://www.webhare.net/xmlns/wrd/components"
         gid="schemamanager"
         library="/lib/screens/schemamanager.whlib">

  <messageboxes gid=".messageboxes">
    <messagebox name="import_schema_replaced" icon="information" buttons="ok" />
    <messagebox name="import_schema_protected" icon="error" buttons="ok" />
    <messagebox name="import_schema_norights" icon="error" buttons="ok" />
    <messagebox name="import_schema_errors" icon="error" buttons="ok" />
  </messageboxes>

  <screen name="main"
          width="95x"
          height="35x"
          allowresize="true"
          defaultbutton="openschemabutton"
          flags="right_superuser right_schemacreate"
          gid=".main"
          savestate="true">
    <actions gid=".actions">
      <action name="openschema" onexecute="doopenschema" tid="~open">
        <enableon source="schemas" min="1" max="1" />
      </action>
      <action name="close" onexecute="cancel" />
      <action name="gotoid"
              frameflags="right_superuser"
              onexecute="dogotoid"
              shortcut="ctrl+shift+g"
              tid="tolliumapps.schemamanager.gotoid.gotoid" />
      <action name="newschema" frameflags="right_schemacreate" onexecute="doaddschema" />
      <action name="delschema" frameflags="right_superuser" onexecute="dodelschema">
        <enableon source="schemas" min="1" />
      </action>
      <action name="editschema" frameflags="right_schemacreate" onexecute="doeditschema">
        <enableon source="schemas" min="1" max="1" />
      </action>
      <uploadaction name="importschema" frameflags="right_schemacreate" onupload="onimport" />
      <action name="synchronize" onexecute="DoSynchronize">
        <enableon source="schemas" min="1" max="1" checkflags="!isprotected right_metadata" />
      </action>
    </actions>

    <compositions>
      <eventlistener masks="wrd:schema.list" onevents="GotSchemaListUpdate" />
    </compositions>

    <body>
      <grid height="1pr">
        <col width="1pr" />
        <col />
        <row height="1pr">
          <cell>
            <list name="schemas"
                  flags="right_metadata isprotected"
                  icons="tollium:status/pinned tollium:users/users"
                  openaction="openschema"
                  selectmode="multiple">
              <acceptdrops ondrop="ondrop">
                <acceptfile frameflags="right_schemacreate" />
              </acceptdrops>
              <column name="tag" type="text" width="2pr" tid="~tag" />
              <column name="title" type="text" width="3pr" tid="~title" />
              <column name="protected" type="icon" />
              <column name="usermgmt" type="icon" />
            </list>
          </cell>
          <cell>
            <button width="1pr" action="newschema" tid="~add" />
            <button width="1pr" action="editschema" tid="~edit" />
            <button width="1pr" action="delschema" tid="~delete" />
            <spacer height="1gr" />
            <button width="1pr" action="gotoid" />
            <button width="1pr" action="importschema" tid="~import" />
            <button width="1pr" action="synchronize" tid="~synchronize" />
          </cell>
        </row>
      </grid>
    </body>

    <footer>
      <line layout="right">
        <button name="openschemabutton" action="openschema" tid="~open" />
        <button tid="~cancel" tolliumresult="cancel" />
      </line>
    </footer>
  </screen>

  <screen name="newschema" width="50x" footerbuttons="ok cancel" gid=".newschema">
    <body>
      <textedit name="name" width="1pr" maxlength="256" required="true" tid="~tag" />
      <textarea name="description" height="5x" maxlength="1024" tid="~description" />
    </body>
  </screen>

  <screen name="importschema" footerbuttons="ok cancel" gid=".importschema">
    <body>
      <checkbox name="ignoremissingreferences" labeltid=".ignoremissingreferences" title="" value="true" />
      <textedit name="renameto" />
    </body>
  </screen>

  <screen name="schemaprops" footerbuttons="ok cancel" gid=".schemaprops">
    <compositions>
      <record name="wrdschema" />
      <record name="paymentapiconfig" />
    </compositions>

    <body spacers="none">
      <tabs>
        <tab name="schema">
          <textedit composition="wrdschema" cellname="name" maxlength="256" required="true" tid="~tag" />
          <textedit composition="wrdschema" cellname="title" maxlength="256" tid="~title" />
          <textarea composition="wrdschema" cellname="description" maxlength="1024" tid="~description" />
          <line layout="left">
            <checkbox composition="wrdschema" cellname="protected" name="protected" labeltid=".protect" title="" />
          </line>
          <line layout="left">
            <checkbox composition="wrdschema" cellname="usermgmt" name="usermgmt" labeltid=".usermgmt" title="" />
          </line>
          <select composition="wrdschema"
                  cellname="accounttype"
                  name="accounttype"
                  type="pulldown"
                  onchange="onaccounttypechange"
                  rowkeytype="integer" />
          <select composition="wrdschema" cellname="accountemail" name="accountemail" type="pulldown" rowkeytype="integer" />
          <select composition="wrdschema" cellname="accountlogin" name="accountlogin" type="pulldown" rowkeytype="integer" />
          <select composition="wrdschema"
                  cellname="accountpassword"
                  name="accountpassword"
                  type="pulldown"
                  rowkeytype="integer" />
          <datetime composition="wrdschema"
                    cellname="creationdate"
                    type="datetime"
                    readonly="true"
                    storeutc="true"
                    tid="~creationdate" />
        </tab>
        <tab name="addressvalidation">
          <wrd:addressvalidation name="validationsettings" />
        </tab>
      </tabs>
    </body>
  </screen>

  <screen name="synchronizeschema" width="90x" height="20x" allowresize="true" footerbuttons="close" savestate="size">
    <body>
      <listedit name="syncpoints"
                height="1pr"
                emptytid=".nosyncpoints"
                ongetrows="ongetsyncpoints"
                onrowdelete="ondeletesyncpoint"
                onrowedit="oneditsyncpoint">
        <column name="peer" type="text" />
        <column name="remotewrdschema" type="text" />
      </listedit>
    </body>
  </screen>

  <screen name="editschemasyncpoint" footerbuttons="ok cancel">
    <actions>
      <action name="selectpeer" onexecute="DoSelectPeer" tid="~select" />
    </actions>

    <compositions>
      <record name="rec" />
    </compositions>

    <body>
      <line>
        <textedit composition="rec" cellname="peer" name="peer" enabled="false" hiderequiredifdisabled="false" />
        <button action="selectpeer" />
      </line>
      <line>
        <textedit composition="rec" cellname="remotewrdschema" name="remotewrdschema" width="1pr" required="true" />
      </line>
    </body>
  </screen>

  <screen name="deleteschemaprod" defaultbutton="cancelbutton" gid="tolliumapps.schemamanager.deleteschemaprod" title="">
    <actions>
      <action name="deleteschema" onexecute="submit" title="" />
    </actions>

    <body spacers="none">
      <statuspanel name="prodwarning" type="warning">
        <text valuetid=".prodwarning" wordwrap="true" />
      </statuspanel>
      <grid>
        <cell spacers="top bottom left">
          <image name="pvt_icon" width="32px" height="32px" title="" value="tollium:messageboxes/warning" />
        </cell>
        <cell minwidth="50x" layout="left" spacers="all">
          <text name="warndeletion" title="" />
          <checkbox name="confirmmoduleowneddeletion" onchange="onconfirmchange" title="" />
        </cell>
      </grid>
    </body>

    <footer>
      <line layout="right">
        <button action="deleteschema" />
        <button name="cancelbutton" tid="~cancel" tolliumresult="cancel" />
      </line>
    </footer>
  </screen>

  <screen name="gotoid" footerbuttons="ok cancel" gid="tolliumapps.schemamanager.gotoid">
    <body>
      <textedit name="id" emptyvalue="0" required="true" valuetype="integer" />
    </body>
  </screen>

</screens>
