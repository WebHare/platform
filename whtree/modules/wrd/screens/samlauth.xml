<screens xmlns="http://www.webhare.net/xmlns/tollium/screens"
         xmlns:wrd="http://www.webhare.net/xmlns/wrd/components"
         gid="samlauth"
         library="/lib/screens/samlauth.whlib">

  <messageboxes gid="types.messages">
    <messagebox name="notconfiguredforsaml" icon="information" buttons="close" />
    <messagebox name="authnotcorrectlyconfigured" icon="error" buttons="close" />
    <messagebox name="suredeletesp" icon="question" buttons="yes no" />
    <messagebox name="suredeleteidp" icon="question" buttons="yes no" />
    <messagebox name="suredeleteconnectedsp" icon="question" buttons="yes no" />
    <messagebox name="suredeleteconnectedidp" icon="question" buttons="yes no" />
  </messageboxes>

  <screen name="main"
          width="120x"
          height="30x"
          allowresize="true"
          flags="selected_sp selected_idp haveidp haveconnected"
          footerbuttons="close"
          gid=".main"
          savestate="size">
    <actions>
      <action name="addidp">
        <enableon source="samlproviders" frameflags="!haveidp" onexecute="doaddidp" />
      </action>
      <action name="addsp">
        <enableon source="samlproviders" onexecute="doaddsp" />
      </action>
      <action name="addconnectedsp" onexecute="doaddconnectedsp">
        <enableon source="samlproviders" min="1" checkflags="idp" />
        <enableon source="connectedproviders" frameflags="selected_idp" />
      </action>
      <action name="addconnectedidp" onexecute="doaddconnectedidp">
        <enableon source="samlproviders" min="1" checkflags="sp !haveconnected" />
        <enableon source="connectedproviders" frameflags="selected_sp !haveconnected" />
      </action>
      <action name="edit" tid="~properties">
        <enableon source="samlproviders" min="1" checkflags="sp" onexecute="doeditsp" />
        <enableon source="samlproviders" min="1" checkflags="idp" onexecute="doeditidp" />
        <enableon source="connectedproviders" min="1" checkflags="sp" onexecute="doeditconnectedsp" />
        <enableon source="connectedproviders" min="1" checkflags="idp" onexecute="doeditconnectedidp" />
      </action>
      <action name="delete" tid="~delete">
        <enableon source="samlproviders" min="1" checkflags="sp" onexecute="dodeletesp" />
        <enableon source="samlproviders" min="1" checkflags="idp" onexecute="dodeleteidp" />
        <enableon source="connectedproviders" min="1" checkflags="sp" onexecute="dodeleteconnectedsp" />
        <enableon source="connectedproviders" min="1" checkflags="idp" onexecute="dodeleteconnectedidp" />
      </action>
      <windowopenaction name="idpinitiatedlogin">
        <enableon source="connectedproviders" min="1" checkflags="sp" onwindowopen="doidpinitiatedlogin" />
      </windowopenaction>
    </actions>

    <menus>
      <menu name="addmenu">
        <item action="addidp" tid=".idp" />
        <item action="addsp" tid=".sp" />
        <item action="addconnectedidp" tid=".connectedidp" />
        <item action="addconnectedsp" tid=".connectedsp" />
      </menu>
      <menu name="contextmenu">
        <item action="addidp" disablemode="hidden" />
        <item action="addsp" disablemode="hidden" />
        <item action="addconnectedidp" disablemode="hidden" />
        <item action="addconnectedsp" disablemode="hidden" />
        <item action="edit" disablemode="hidden" />
        <item action="delete" disablemode="hidden" />
      </menu>
      <menu name="connectedcontextmenu">
        <item action="addconnectedidp" disablemode="hidden" />
        <item action="addconnectedsp" disablemode="hidden" />
        <item action="edit" disablemode="hidden" />
        <item action="delete" disablemode="hidden" />
        <divider />
        <item action="idpinitiatedlogin" disablemode="hidden" />
      </menu>
    </menus>

    <compositions>
      <eventlistener name="eventlistener" onevents="gotevents" />
    </compositions>

    <toolbar>
      <button icon="tollium:actions/add" menu="addmenu" tid="~add" />
      <button action="edit" icon="tollium:actions/properties" />
      <button action="delete" icon="tollium:actions/delete" />
      <divider />
      <button action="idpinitiatedlogin" icon="tollium:actions/import" />
    </toolbar>

    <body>
      <split type="horizontal">
        <part width="1pr">
          <wrd:entitylist name="samlproviders"
                          borders="top left bottom"
                          flags="sp idp haveconnected"
                          newcontextmenu="contextmenu"
                          onmaprows="onmapsamlprovidersrows"
                          onselect="onproviderselect"
                          openaction="edit"
                          requestcolumns="wrd_tag wrd_type samlentityid"
                          selectcontextmenu="contextmenu">
            <column name="type" type="text" width="10x" />
            <column name="wrd_tag" type="text" />
            <column name="samlentityid" type="text" />
          </wrd:entitylist>
        </part>
        <part width="1pr">
          <wrd:entitylist name="connectedproviders"
                          borders="top right bottom"
                          flags="sp idp"
                          newcontextmenu="connectedcontextmenu"
                          onmaprows="onmapconnectedprovidersrows"
                          openaction="edit"
                          requestcolumns="samlentityid"
                          selectcontextmenu="connectedcontextmenu">
            <column name="samlentityid" type="text" tid=".connectedsamlentityid" />
          </wrd:entitylist>
        </part>
      </split>
    </body>
  </screen>

  <screen name="editprovider"
          width="120x"
          height="30x"
          allowresize="true"
          footerbuttons="ok cancel"
          gid=".editprovider"
          savestate="size">
    <compositions>
      <wrd:entity name="entity" />
    </compositions>

    <body>
      <textedit composition="entity" cellname="samlentityid" width="1pr" required="true" validationchecks="http-url" />
      <textedit composition="entity" cellname="wrd_tag" required="true" />
      <select name="keypair" type="pulldown" rowkeytype="integer" />
      <line layout="left">
        <checkbox composition="entity" cellname="allow_redirectbinding" labeltid=".allow_redirectbinding" title="" />
      </line>
      <select composition="entity" cellname="hashmethod" type="pulldown" required="true">
        <option rowkey="SHA-1" />
        <option rowkey="SHA-224" />
        <option rowkey="SHA-256" />
        <option rowkey="SHA-384" />
        <option rowkey="SHA-512" />
      </select>

      <!-- idp only -->
      <heading name="nameidformatsheading" tid=".supportednameidformats" />
      <arrayedit composition="entity"
                 cellname="supportednameidformats"
                 name="supportednameidformats"
                 roweditscreen="#editnameidformat">
        <column name="nameidformat" type="text" />
      </arrayedit>

      <!-- sp only -->
      <combobox composition="entity" cellname="nameidpolicy" name="nameidpolicy" width="1pr">
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified" />
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" />
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:WindowsDomainQualifiedName" />
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:entity" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:kerberos" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
      </combobox>
      <heading tid=".organizationinfo" />
      <textedit composition="entity" cellname="organization_name" required="true" />
      <textedit composition="entity" cellname="organization_displayname" required="true" />
      <textedit composition="entity" cellname="organization_url" required="true" />
      <heading tid=".contacts" />
      <arrayedit composition="entity" cellname="contacts" height="1pr" roweditscreen=".editcontact">
        <column name="type" type="text" />
        <column name="company" type="text" />
        <column name="givenname" type="text" />
        <column name="surname" type="text" />
        <column name="email" type="text" tid="~email" />
        <column name="telephone" type="text" />
      </arrayedit>
    </body>
  </screen>

  <screen name="editcontact" footerbuttons="ok cancel" gid=".editcontact" implementation="rowedit">
    <compositions>
      <record name="row" />
    </compositions>

    <body>
      <select composition="row" cellname="type" type="pulldown" required="true">
        <option rowkey="technical" />
        <option rowkey="support" />
        <option rowkey="administrative" />
        <option rowkey="billing" />
        <option rowkey="other" />
      </select>
      <textedit composition="row" cellname="company" />
      <textedit composition="row" cellname="givenname" />
      <textedit composition="row" cellname="surname" />
      <textedit composition="row" cellname="email" tid="~email" />
      <textedit composition="row" cellname="telephone" />
    </body>
  </screen>

  <screen name="editconnectedprovider"
          width="120x"
          allowresize="true"
          footerbuttons="ok cancel"
          gid=".editconnectedprovider"
          savestate="size">
    <actions>
      <action name="downloadmetadata" onexecute="dodownloadmetadata" />
      <action name="entermetadata" onexecute="doentermetadata" />
    </actions>

    <compositions>
      <wrd:entity name="entity" />
    </compositions>

    <body>
      <line>
        <textedit composition="entity" cellname="metadataurl" name="metadataurl" width="1pr" validationchecks="http-url" />
        <button action="downloadmetadata" />
        <button action="entermetadata" />
      </line>
      <textedit composition="entity"
                cellname="samlentityid"
                name="samlentityid"
                width="1pr"
                required="true"
                validationchecks="http-url" />
      <heading tid=".serviceendpoints" />
      <arrayedit composition="entity"
                 cellname="serviceendpoints"
                 height="1pr"
                 onmaprows="onmapserviceendpointrows"
                 roweditscreen=".editserviceendpoint">
        <column name="type" type="text" />
        <column name="binding" type="text" />
        <column name="location" type="text" />
        <column name="responselocation" type="text" />
        <column name="index" type="text" width="10x" />
        <column name="isdefault" type="text" width="10x" />
      </arrayedit>

      <!-- connected idp only -->
      <heading name="nameidformatsheading" tid=".supportednameidformats" />
      <arrayedit composition="entity"
                 cellname="supportednameidformats"
                 name="supportednameidformats"
                 roweditscreen="#editnameidformat">
        <column name="nameidformat" type="text" />
      </arrayedit>
      <heading tid=".certificates" />
      <arrayedit composition="entity"
                 cellname="certificates"
                 height="1pr"
                 onmaprows="onmapcertificaterows"
                 roweditscreen=".editcertificate">
        <column name="commonname" type="text" />
        <column name="validuntil" type="date" />
        <column name="acceptuntil" type="date" />
      </arrayedit>

      <!-- connected sp only -->
      <heading name="othersettingsheading" tid=".othersettings" />
      <line layout="left">
        <checkbox composition="entity"
                  cellname="signature_optional"
                  name="signature_optional"
                  labeltid=".signature_optional"
                  title="" />
      </line>
      <heading tid=".organizationinfo" />
      <textedit composition="entity" cellname="organization_name" />
      <textedit composition="entity" cellname="organization_displayname" />
      <textedit composition="entity" cellname="organization_url" />
      <heading tid=".contacts" />
      <arrayedit composition="entity" cellname="contacts" height="1pr" roweditscreen=".editcontact">
        <column name="type" type="text" />
        <column name="company" type="text" />
        <column name="givenname" type="text" />
        <column name="surname" type="text" />
        <column name="email" type="text" tid="~email" />
        <column name="telephone" type="text" />
      </arrayedit>
    </body>
  </screen>

  <screen name="entermetadata"
          width="100x"
          height="30x"
          allowresize="true"
          footerbuttons="ok cancel"
          gid=".entermetadata"
          savestate="size">
    <body>
      <text valuetid=".metadataexplain" />
      <codeedit name="metadata" height="1pr" />
    </body>
  </screen>

  <screen name="importchangedcertificate" footerbuttons="ok cancel" gid=".importchangedcertificate">
    <body>
      <line layout="left">
        <text valuetid=".explain" />
      </line>
      <select name="certchoice" type="radio">
        <option rowkey="replace" />
        <option rowkey="expireold">
          <datetime name="certuseuntil" type="date" title="" />
        </option>
      </select>
    </body>
  </screen>

  <screen name="editserviceendpoint"
          width="100x"
          allowresize="true"
          footerbuttons="ok cancel"
          gid=".editserviceendpoint"
          implementation="rowedit"
          savestate="size">
    <compositions>
      <record name="row" />
    </compositions>

    <body>
      <select composition="row" cellname="type" type="pulldown">
        <option rowkey="SingleLogoutService" />
        <option rowkey="SingleSignonService" />
        <option rowkey="ArtifactResolutionService" />
        <option rowkey="AssertionConsumerService" />
        <option rowkey="AttributeConsumingService" />
      </select>
      <select composition="row" cellname="binding" type="pulldown">
        <option rowkey="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect" tid=".http-redirect" />
        <option rowkey="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" tid=".http-post" />
      </select>
      <textedit composition="row" cellname="location" width="1pr" required="true" validationchecks="http-url" />
      <textedit composition="row" cellname="responselocation" width="1pr" validationchecks="http-url" />
      <textedit composition="row" cellname="index" width="1pr" valuetype="integer" />
      <line layout="left">
        <checkbox composition="row" cellname="isdefault" labeltid=".isdefault" title="" />
      </line>
    </body>
  </screen>

  <screen name="editcertificate"
          allowresize="true"
          footerbuttons="ok cancel"
          gid=".editcertificate"
          implementation="rowedit"
          savestate="size">
    <compositions>
      <record name="row" />
    </compositions>

    <body>
      <fileedit composition="row" cellname="data" />
      <datetime composition="row" cellname="acceptuntil" type="date" />
    </body>
  </screen>

  <screen name="editnameidformat" footerbuttons="ok cancel" implementation="rowedit">
    <compositions>
      <record name="row" />
    </compositions>

    <body>
      <combobox composition="row" cellname="nameidformat">
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified" />
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" />
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:WindowsDomainQualifiedName" />
        <option title="urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:entity" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:kerberos" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent" />
        <option title="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" />
      </combobox>
    </body>
  </screen>

</screens>
