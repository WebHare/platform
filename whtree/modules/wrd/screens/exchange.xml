<screens xmlns="http://www.webhare.net/xmlns/tollium/screens" gid="exchange" library="/lib/screens/exchange.whlib">

  <messageboxes gid=".messageboxes">
    <messagebox name="distinctoverflow" buttons="ok" />
  </messageboxes>

  <screen name="import"
          minwidth="600px"
          minheight="400px"
          allowresize="true"
          flags="canlinkitem"
          gid=".import"
          savestate="size">
    <actions>
      <action name="map" frameflags="canlinkitem" onexecute="domap" />
      <action name="unmap" onexecute="dodeletelink">
        <enableon source="incolumns" min="1" max="1" checkflags="islinked" />
      </action>
      <action name="updatemapping" onexecute="doupdatemapping">
        <enableon source="incolumns" min="1" max="1" checkflags="ismapped" />
      </action>
      <action name="deletelink" onexecute="dodeletelink">
        <enableon source="incolumns" min="1" max="1" checkflags="islinked" />
      </action>
    </actions>

    <menus>
      <menu name="incolumnsmenu">
        <item action="updatemapping" disablemode="hidden" />
        <item action="deletelink" disablemode="hidden" />
      </menu>
    </menus>

    <body spacers="none">
      <wizard name="wizard" height="1pr">
        <page name="importdatapage" oninit="onimportdatapageinit" onnext="onimportdatapagenext">
          <panel name="importdescriptionpanel" layout="left" visible="false">
            <text name="importdescriptiontext" width="1pr" title="" wordwrap="true" />
          </panel>
          <box name="fileuploadbox" hr="false">
            <line layout="left">
              <text valuetid=".choosefile" />
            </line>
            <fileedit name="importfile"
                      onbeforechange="onbeforeimportfilechange"
                      onchange="onimportfilechange"
                      required="true" />
          </box>
        </page>
        <page name="columnspage" oninit="oncolumnspageinit" onnext="oncolumnspagenext" spacers="left top bottom">
          <box name="mapbox" height="1pr" hr="false">
            <text width="1pr" title="" valuetid=".mapexplain" wordwrap="true" />
            <panel layout="left" spacers="bottom">
              <select name="headertype" type="radio" onchange="onheadertypechange" title="">
                <option rowkey="withheaders" selected="true" />
                <option rowkey="noheaders" />
              </select>
            </panel>
            <split type="horizontal">
              <part width="3pr">
                <!-- FIXME: Better use WRD icons(?) -->
                <list name="incolumns"
                      width="100x"
                      height="1pr"
                      borders="left top bottom"
                      flags="ismapped islinked"
                      icons="tollium:objects/idcard
                             tollium:forms/pulldown
                             tollium:forms/textedit
                             tollium:forms/textedit
                             tollium:objects/envelope
                             tollium:forms/textedit
                             tollium:forms/textedit"
                      onselect="onincolumnsselect"
                      openaction="updatemapping"
                      selectcontextmenu="incolumnsmenu"
                      selectmode="single"
                      sortcolumn="columnname">
                  <acceptdrops ondrop="onincolumndrop">
                    <accepttype type="local:targetattribute" dropeffects="move" requiretarget="true" sourceflags="islinkable" />
                  </acceptdrops>

                  <!-- column type="integer" name="rowkey" width="4x" / -->
                  <column name="columnname" type="text" />
                  <column name="exampledata" type="text" />

                  <!-- FIXME: Check FIXME in whlib's BuildImportColumnsList
                  <column type="text" name="importcolumn" iconname="typeicon"/>
                  -->
                  <column name="importcolumn" type="text" />
                </list>
              </part>
              <part width="2pr" spacers="left">
                <grid width="1pr" height="1pr">
                  <col />
                  <col width="1pr" />
                  <row height="1pr">
                    <cell>
                      <panel height="1pr" spacers="all" />
                      <button width="1pr" action="map" />
                      <button width="1pr" action="unmap" />
                      <panel height="1pr" />
                    </cell>
                    <cell>
                      <list name="wrdcolumns"
                            width="1pr"
                            flags="islinkable"
                            icons="tollium:forms/textedit
                                   tollium:forms/pulldown
                                   tollium:forms/textedit
                                   tollium:forms/textedit
                                   tollium:forms/email
                                   tollium:forms/textedit
                                   tollium:forms/textedit"
                            onselect="onwrdcolumnsselect"
                            openaction="map"
                            selectmode="single">
                        <acceptdrops ondrop="onwrdcolumndrop">
                          <accepttype type="local:importcolumn"
                                      dropeffects="move"
                                      requiretarget="false"
                                      sourceflags="islinked" />
                        </acceptdrops>
                        <column name="title" type="text" iconname="typeicon" tree="true" />

                        <!-- column type="text" name="stringicon"/ -->
                        <style name="isrequired" bold="true" />
                      </list>
                    </cell>
                  </row>
                </grid>
              </part>
            </split>
          </box>
        </page>
        <page name="startimport" isfinish="true" oninit="onstartimportinit">
          <box hr="false" tid=".previewexplainbox">
            <text width="1pr" valuetid=".clicknexttostart" wordwrap="true" />
          </box>
          <panel height="1pr">
            <list name="previewrows" height="1pr" />
          </panel>
        </page>
      </wizard>
    </body>
  </screen>

  <screen name="importresults" footerbuttons="close" gid=".importresults">
    <actions>
      <action name="downloadduplicate" onexecute="dodownloadduplicate" />
      <action name="downloadinvalid" onexecute="dodownloadinvalid" />
    </actions>

    <body>
      <text name="numnew" />
      <text name="numupdate" />
      <line>
        <text name="numinvalid" />
        <text name="downloadinvalid_button" action="downloadinvalid" title="" valuetid=".downloadinvalid" />
      </line>
      <line>
        <text name="numduplicate" />
        <text name="downloadduplicate_button" action="downloadduplicate" title="" valuetid=".downloadduplicate" />
      </line>
    </body>
  </screen>

  <screen name="mapdomain" allowresize="true" flags="canmapitem" footerbuttons="ok cancel" gid=".mapdomain" savestate="size">
    <actions>
      <action name="map" frameflags="canmapitem" onexecute="domap" />
      <action name="unmap" onexecute="dounmap">
        <enableon source="invals" min="1" max="1" checkflags="ismapped" />
      </action>
    </actions>

    <body>
      <text name="remapinfo" width="1pr" title="" valuetid=".remapinfo" wordwrap="true" />
      <split type="horizontal">
        <part width="2pr">
          <list name="invals"
                borders="left top bottom"
                flags="ismapped"
                onselect="onlistselect"
                selectmode="single"
                sortcolumn="inval">
            <acceptdrops ondrop="oninvaldrop">
              <accepttype type="local:allowedval" requiretarget="true" />
            </acceptdrops>
            <column name="inval" type="text" />
            <column name="occurences" type="integer" width="6x" />
            <column name="maptoval" type="text" />
          </list>
        </part>
        <part width="2pr" spacers="left">
          <grid width="1pr" height="1pr">
            <col />
            <col width="1pr" />
            <row height="1pr">
              <cell>
                <panel height="1pr" />
                <button width="1pr" action="map" />
                <button width="1pr" action="unmap" />
                <panel height="1pr" />
              </cell>
              <cell>
                <list name="allowedvals" minwidth="25x" onselect="onlistselect" openaction="map" selectmode="single">
                  <acceptdrops ondrop="onallowedvaldrop">
                    <accepttype type="local:inval" requiretarget="false" sourceflags="ismapped" />
                  </acceptdrops>
                  <column name="title" type="text" />
                </list>
              </cell>
            </row>
          </grid>
        </part>
      </split>
    </body>
  </screen>

  <screen name="syncoptions" footerbuttons="ok cancel" gid=".syncoptions" title="">
    <actions>
      <action name="selectall" onexecute="doselectall" title="" />
      <action name="selectnone" onexecute="doselectnone" title="" />
      <action name="selectnonpersonal" onexecute="doselectnonpersonal" title="" />
    </actions>

    <body layout="left">
      <text name="synctypelabel" labelfor="synctype" title="" />
      <select name="synctype" type="radio" onchange="onsynctypechange" title="">
        <option rowkey="nonpersonaldata" />
        <option rowkey="alldata" />
        <option rowkey="selecttypes" />
      </select>
      <line>
        <spacer width="16px" />
        <inlineblock name="selecttypes" title="">
          <list name="includetypes"
                width="40x"
                height="20x"
                columnheaders="false"
                icons="tollium:users/user"
                oncheck="onselectedcheck">
            <column name="title" type="text" checkboxname="selected" sortkeyname="sortpersonaldata" title="" />
            <column name="haspersonaldata" type="icon" title="" />
          </list>
          <line>
            <text tid=".select" />
            <text action="selectall" title="" valuetid=".select-all" />
            <text action="selectnone" title="" valuetid=".select-none" />
            <text action="selectnonpersonal" title="" valuetid=".select-nonpersonal" />
          </line>
        </inlineblock>
      </line>
    </body>
  </screen>

</screens>
