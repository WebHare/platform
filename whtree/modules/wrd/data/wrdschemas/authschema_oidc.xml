<schemadefinition xmlns="http://www.webhare.net/xmlns/wrd/schemadefinition">

  <import definitionfile="/data/wrdschemas/authschema.xml" />

  <object tag="wrdauth_oidc_client" keephistorydays="1100">
    <!-- keep history for about 3 years (1 or 2 rotations if secrets expire after 1 or 2 years) -->

    <!-- these are our OIDC Client Registrations, ie where this WRD Schema is a service provider to an external identity provider.
         ie: the list of login buttons we offer. (wrdauth_service_provider is the inverse)
    -->
    <attributes>
      <free tag="wrd_title" required="true" unique="true" />
      <integer tag="wrd_ordering" />  <!-- TODO make this object a domain and then use the builtin wrd_ordering -->
      <free tag="metadataurl" />
      <free tag="clientid" />
      <json tag="client_signing" unsafetocopy="true" typedeclaration="@webhare/auth#ClientSigning" />
      <free tag="clientsecret" unsafetocopy="true" description="Old string format client secret key"/>
      <datetime tag="secret_expiration" description="When is the secret known to expire (allows us to give warnings)" />
      <free tag="additionalscopes" />
      <free tag="loginfield" />  <!-- eg 'email' or 'sub'.  todo should default to 'sub' but transitionally support email/employeeid/sub -->
      <free tag="redirect_uri"
            description="Override the redirect URI used. Must point a page implementing the OAuth2 landing code" />
      <enum tag="visibility"
            allowedvalues="hidden ifused"
            description="Limit visibility of this login option. hidden: always hide. ifused: show after first use or triggering. " />
      <free tag="comments" />
      <image tag="icon" />
    </attributes>
  </object>

</schemadefinition>
