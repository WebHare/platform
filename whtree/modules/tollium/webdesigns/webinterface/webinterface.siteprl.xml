<siteprofile xmlns="http://www.webhare.net/xmlns/publisher/siteprofile">

  <!-- Global site settings -->
  <apply>
    <to type="all" />

    <!-- Set site language -->
    <sitelanguage lang="en" />

    <!-- disable keywords field -->
    <baseproperties keywords="false" />
    <wrdauth xmlns="http://www.webhare.net/xmlns/wrd"
             wrdschema="system:usermgmt"
             cookiename="webharelogin-webharebackend"
             lastloginfield="WHUSER_LASTLOGIN"
             loginpage="currentsite::/" />

    <!-- Setup default webdesign. Sync with tollium/data/siteprofile.xml. We need it here for 404 and /.publisher/debug pages -->
    <webdesign assetpack="platform:tollium"
               designfolder="mod::tollium/webdesigns/webinterface"
               maxcontentwidth="960px"
               objectname="mod::tollium/webdesigns/webinterface/lib/webinterface.whlib#WebinterfaceDesign"
               supportsaccessdenied="true"
               supportserrors="true"
               witty="mod::tollium/webdesigns/webinterface/witty/webinterface.witty"
               wittyencoding="HTML-NI" />

    <!-- Explicitly don't allow imgedit/fileedit, they're not used in Tollium forms (i.e. login pages) -->
    <denyformquestion type="http://www.webhare.net/xmlns/publisher/forms#imgedit" />
    <denyformquestion type="http://www.webhare.net/xmlns/publisher/forms#upload" />
    <rtddoc rtdtype="http://www.webhare.net/xmlns/tollium/webinterface" />
  </apply>

  <!-- The RTD type used for system news and authpages (it's a superset of the authpages rtdtype) -->
  <rtdtype namespace="http://www.webhare.net/xmlns/tollium/webinterface">
    <blockstyles defaultstyle="NORMAL">
      <textstyle tag="HEADING2" textstyles="" />
      <textstyle tag="HEADING3" textstyles="" />
      <textstyle tag="NORMAL" textstyles="b i u a-href img sup sub strike" />
      <textstyle tag="UNORDERED" containertag="ul" textstyles="b i u a-href img sup sub strike" />
      <textstyle tag="ORDERED" containertag="ol" textstyles="b i u a-href img sup sub strike" />
    </blockstyles>
  </rtdtype>

  <!-- on dev servers, open up a /testportal -->
  <apply maxservertype="development">
    <to type="file" pathmask="/testportal" />
    <portal xmlns="http://www.webhare.net/xmlns/tollium" allowinframe="true" />
    <wrdauth xmlns="http://www.webhare.net/xmlns/wrd"
             wrdschema="wrd:testschema"
             cookiename="webharelogin-testportal"
             loginpage="currentsite::/testportal" />
  </apply>

  <applysiteprofile path="pages/manual/manual.siteprl.xml" />

  <!-- on test and above, /testportal just blocks -->
  <sitesettings>
    <webruleset xmlns="http://www.webhare.net/xmlns/system/moduledefinition">
      <webrule path="/" match="initial">
        <!-- <addheader header="X-Frame-Options" value="DENY"/>  applicationportal.whlib controls this currently -->
        <addheader header="X-XSS-Protection" value="1; mode=block" />
        <addheader header="X-Content-Type-Options" value="nosniff" />
        <addheader header="Referrer-Policy" value="no-referrer" />
      </webrule>
      <openapi path="/.wh/api/v1/" service="platform:api" />

      <!-- protect the testportal page from being accessed on non-development servers -->
      <webrule path="/testportal" match="initial" allowips="" minservertype="test" />
      <webrule path="/" match="initial" maxservertype="development">
        <csp policy="script-src 'self' maps.googleapis.com" />
      </webrule>
    </webruleset>
  </sitesettings>

</siteprofile>
